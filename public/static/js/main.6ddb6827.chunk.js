(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{137:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(36),c=a.n(o),i=a(11),l=a.n(i),u=a(17),s=a(10),d=a(4),p=a(90),m=a(34),f=a(84),b=a(64),h=a(152),g=a(43),v=r.a.createContext({user:null,displayName:"",friendCode:""}),x=a(151),E=a(80),w=(a(98),a(99),a(101),E.initializeApp({apiKey:"AIzaSyDlxImm5-7T7AzdMAbJO-86ijR1c5g6vDM",authDomain:"battleship-ish.firebaseapp.com",databaseURL:"https://battleship-ish.firebaseio.com",projectId:"battleship-ish",storageBucket:"battleship-ish.appspot.com",messagingSenderId:"57723460313",appId:"1:57723460313:web:f55fa72d03e38eea77bcc8"})),j=w.auth(),C=w.firestore(),y=w.functions("europe-west1"),O=a(15),S=a(24),k=a(144),I=a(143),A=a(65),R=a(28),M=function(e){var t=e.children,a=e.variantColor,n=void 0===a?"purple.400":a,o=e.isDisabled,c=Object(A.a)(e,["children","variantColor","isDisabled"]),i=n.split("."),l=parseInt(i[1],10),u=i[0];return r.a.createElement(R.a,Object.assign({as:"button",d:"flex",bg:n,py:2,pb:1,px:4,alignItems:"center",borderRadius:6,borderBottomColor:"".concat(u,".").concat(Math.min(l+100,900)),borderBottomWidth:4,transition:"all 0.2s ease",outline:"none","aria-disabled":o,_hover:{backgroundColor:"".concat(u,".").concat(Math.min(l+100,900)),borderBottomColor:"".concat(u,".").concat(Math.min(l+200,900))},_focus:{boxShadow:"outline"},_active:{borderBottomWidth:"2px",mt:"2px"},_disabled:{opacity:.5,cursor:"not-allowed"}},c),t)},W=function(e){var t=e.children,a=e.variantColor,n=void 0===a?"purple.300":a,o=Object(A.a)(e,["children","variantColor"]),c=n.split("."),i=parseInt(c[1],10),l=c[0];return r.a.createElement(R.a,Object.assign({as:"button",d:"flex",bg:n,p:2,alignItems:"center",borderRadius:6,borderBottomColor:"".concat(l,".").concat(Math.min(i+100,900)),borderBottomWidth:4,transition:"all 0.2s ease",outline:"none",_hover:{backgroundColor:"".concat(l,".").concat(Math.min(i+100,900)),borderBottomColor:"".concat(l,".").concat(Math.min(i+200,900))},_focus:{boxShadow:"outline"},_active:{borderBottomWidth:"2px",mt:"2px"}},o),t)},z=function(){var e=Object(n.useContext)(v).user,t=Object(n.useRef)([]),a=Object(n.useState)([]),o=Object(s.a)(a,2),c=o[0],i=o[1];Object(n.useEffect)((function(){if(e){var a=C.collection("users").doc(null===e||void 0===e?void 0:e.uid).collection("friend-requests").onSnapshot((function(e){e.docChanges().forEach((function(e){var a=e.doc;if("added"===e.type){var n=Object(S.a)({},a.data(),{id:a.id});t.current=[].concat(Object(O.a)(t.current),[n])}if("modified"===e.type){var r=a.id;t.current=t.current.map((function(e){return e.id!==r?e:Object(S.a)({},a.data(),{id:a.id})}))}if("removed"===e.type){var o=a.id;t.current=t.current.filter((function(e){return e.id!==o}))}})),i(t.current)}));return function(){a()}}}),[e]);var p=function(){var e=Object(u.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=y.httpsCallable("acceptFriendRequest"),e.next=4,a({userId:t});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(I.a,null,r.a.createElement(I.f,null,r.a.createElement(d.a,{as:"button",w:"32px",h:"32px",mr:4,pos:"relative"},r.a.createElement("img",{src:"/icons/users.svg",alt:""}),c.length>0&&r.a.createElement(d.a,{pos:"absolute",display:"fled",justifyContent:"center",alignItems:"center",w:5,h:5,borderRadius:"full",bg:"red.500",color:"white",fontSize:"0.75rem",fontWeight:"800",top:"-0.5rem",right:"-0.5rem"},c.length))),r.a.createElement(I.d,{zIndex:4,maxW:"400px",bg:"purple.600",borderColor:"purple.700"},r.a.createElement(I.b,null),r.a.createElement(I.e,{borderColor:"purple.700"},"Friend requests"),r.a.createElement(I.c,null,r.a.createElement(k.b,null,c.map((function(e){return r.a.createElement(k.a,{d:"flex",p:2,alignItems:"center",justifyContent:"space-between",key:e.id,borderBottom:"1px solid",borderColor:"purple.700"},r.a.createElement(b.a,{whiteSpace:"nowrap",mr:4},e.displayName),r.a.createElement(f.a,null,r.a.createElement(M,{mr:2,variantColor:"green.400",onClick:function(){return p(e.userId)}},r.a.createElement(d.a,{w:"32px",h:"32px",mr:2},r.a.createElement("img",{src:"/icons/like.svg",alt:""})),r.a.createElement(b.a,{fontSize:"1.25rem",fontWeight:"700",color:"white",textShadow:"1px 1px 0px rgba(0,0,0,0.2)"},"Accept")),r.a.createElement(W,{variantColor:"red.400"},r.a.createElement(d.a,{w:"32px",h:"32px"},r.a.createElement("img",{src:"/icons/bad.svg",alt:""})))))}))))))},B=function(){var e=Object(n.useContext)(v).user,t=Object(n.useRef)([]),a=Object(n.useState)([]),o=Object(s.a)(a,2),c=o[0],i=o[1];Object(n.useEffect)((function(){if(e){var a=C.collection("users").doc(null===e||void 0===e?void 0:e.uid).collection("challenges").onSnapshot((function(e){e.docChanges().forEach((function(e){var a=e.doc;if("added"===e.type){var n=Object(S.a)({},a.data(),{id:a.id});t.current=[].concat(Object(O.a)(t.current),[n])}if("modified"===e.type){var r=a.id;t.current=t.current.map((function(e){return e.id!==r?e:Object(S.a)({},a.data(),{id:a.id})}))}if("removed"===e.type){var o=a.id;t.current=t.current.filter((function(e){return e.id!==o}))}})),i(t.current)}));return function(){a()}}}),[e]);var p=function(){var e=Object(u.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=y.httpsCallable("acceptChallenge"),e.next=4,a({userId:t});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(I.a,null,r.a.createElement(I.f,null,r.a.createElement(d.a,{as:"button",w:"32px",h:"32px",mr:4,pos:"relative"},r.a.createElement("img",{src:"/icons/bell.svg",alt:""}),c.length>0&&r.a.createElement(d.a,{pos:"absolute",display:"fled",justifyContent:"center",alignItems:"center",w:5,h:5,borderRadius:"full",bg:"red.500",color:"white",fontSize:"0.75rem",fontWeight:"800",top:"-0.5rem",right:"-0.5rem"},c.length))),r.a.createElement(I.d,{zIndex:4,maxW:"400px",bg:"purple.600",borderColor:"purple.700"},r.a.createElement(I.b,null),r.a.createElement(I.e,{borderColor:"purple.700"},"Game challenges"),r.a.createElement(I.c,null,r.a.createElement(k.b,null,c.map((function(e){return r.a.createElement(k.a,{d:"flex",p:2,alignItems:"center",justifyContent:"space-between",key:e.id,borderBottom:"1px solid",borderColor:"purple.700"},r.a.createElement(b.a,{whiteSpace:"nowrap",mr:4},e.displayName),r.a.createElement(f.a,null,r.a.createElement(M,{mr:2,variantColor:"green.400",onClick:function(){return p(e.userId)}},r.a.createElement(d.a,{w:"32px",h:"32px",mr:2},r.a.createElement("img",{src:"/icons/like.svg",alt:""})),r.a.createElement(b.a,{fontSize:"1.25rem",fontWeight:"700",color:"white",textShadow:"1px 1px 0px rgba(0,0,0,0.2)"},"Accept")),r.a.createElement(W,{variantColor:"red.400"},r.a.createElement(d.a,{w:"32px",h:"32px"},r.a.createElement("img",{src:"/icons/bad.svg",alt:""})))))}))))))},N=function(e){var t,a=e.onStopMatchmaking,o=e.onStartMatchmaking,c=e.isMatchmaking,i=e.time,l=Object(n.useContext)(v).user;return r.a.createElement(f.a,{px:4,align:"center",justify:"space-between",bg:"purple.800",borderBottomWidth:"2px",borderBottomColor:"purple.900",w:"100%",h:"5rem"},r.a.createElement(g.b,{to:"/"},"Bombergrid"),c?r.a.createElement(M,{variantColor:"teal.400",onClick:a},r.a.createElement(b.a,{fontSize:"1.25rem",fontWeight:"700",color:"white",textShadow:"1px 1px 0px rgba(0,0,0,0.2)"},"Searching for opponent ... ",i)):r.a.createElement(M,{variantColor:"teal.400",onClick:o},r.a.createElement(b.a,{fontSize:"1.25rem",fontWeight:"700",color:"white",textShadow:"1px 1px 0px rgba(0,0,0,0.2)"},"Search for opponent")),r.a.createElement(f.a,null,r.a.createElement(z,null),r.a.createElement(B,null),r.a.createElement(x.d,null,r.a.createElement(x.a,null,r.a.createElement(h.a,{size:"sm",name:null!==(t=null===l||void 0===l?void 0:l.displayName)&&void 0!==t?t:void 0})),r.a.createElement(x.c,null,r.a.createElement(x.b,{onClick:function(){j.signOut()}},"Sign out")))))},F=a(20),P=a(86),_=a.n(P),D=function e(){var t=this;Object(F.a)(this,e),this.matchmakingListener=null,this.joinQueue=function(e){return C.collection("matchmaking").doc(e).set({created:_.a.firestore.FieldValue.serverTimestamp()})},this.exitQueue=function(e){return C.collection("matchmaking").doc(e).delete()},this.subMatchmaking=function(e,a,n){t.matchmakingListener=C.collection("matchmaking").doc(e).onSnapshot({includeMetadataChanges:!1},a,n)},this.unsubMatchmaking=function(){t.matchmakingListener&&t.matchmakingListener()}},L=a(29),q=a(149),T=a(145),U=a(146),Y=a(153),H=Array.from(Array(10)).map((function(){return Array.from(Array(10)).map((function(){return!1}))})),Q=function(){var e=Object(n.useContext)(v),t=e.user,a=e.displayName,o=Object(q.a)(),c=Object(m.g)().gameId,i=Object(n.useState)({}),p=Object(s.a)(i,2),h=p[0],g=p[1],x=Object(n.useState)([]),E=Object(s.a)(x,2),w=E[0],j=E[1],S=Object(n.useState)(!1),k=Object(s.a)(S,2),I=k[0],A=k[1],R=Object(n.useState)(!1),W=Object(s.a)(R,2),z=W[0],B=W[1];Object(n.useEffect)((function(){if(t){var e=C.collection("games").doc(c).onSnapshot((function(e){g(e.data())}));return function(){e()}}}),[t,c]);var N=function(){var e=Object(u.a)(l.a.mark((function e(a){var n,r,i,u,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h.currentPlayer===(null===t||void 0===t?void 0:t.uid)&&!I){e.next=4;break}o({title:"Not your turn.",description:"Couldn't fire rocket, its not your turn.",status:"error",duration:3e3,isClosable:!0}),e.next=20;break;case 4:return n=y.httpsCallable("trySquare"),e.prev=5,A(!0),e.next=9,n({square:a,gameId:c});case 9:r=e.sent,i=r.data,u=i.isHit,s=i.gameIsWon,u&&o({title:"You hit one of the ships",status:"info",duration:3e3,isClosable:!0}),s&&o({title:"You one the game!!",description:"Congrats",status:"success",duration:3e3,isClosable:!0}),A(!1),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),console.error(e.t0),A(!1);case 20:case"end":return e.stop()}}),e,null,[[5,16]])})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(u.a)(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(10===w.length){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,C.collection("placements").doc(c).update(Object(L.a)({},t.uid,w));case 5:a=[].concat(Object(O.a)(h.hasPlaced||[]),[null===t||void 0===t?void 0:t.uid]),C.collection("games").doc(c).update({hasPlaced:a}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(){return e.apply(this,arguments)}}();if(!h.players)return r.a.createElement(b.a,null,"Loading");var P=h.players.find((function(e){return e!==t.uid}));return console.log(h),r.a.createElement(f.a,{direction:"column",justify:"space-between"},r.a.createElement(f.a,{direction:"column",p:2},h.winner&&r.a.createElement(T.a,null,"Winner ",h.winner===(null===t||void 0===t?void 0:t.uid)?"You won":"Your opponent won"),"PLAYING"===h.state?r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{textAlign:"center"},h.currentPlayer===(null===t||void 0===t?void 0:t.uid)?"Your":"Opponents"," turn"),r.a.createElement(f.a,{justifyContent:"space-between",w:"100%",maxW:"550px",margin:"0 auto",mb:2},r.a.createElement(d.a,null,r.a.createElement(b.a,{fontSize:"0.75rem"},a),h.hits&&r.a.createElement(d.a,{borderRadius:"md",d:"flex",w:"128px",h:"32px",bg:"purple.500",justifyContent:"space-around",p:1,transform:"skewX(12deg)"},h.hits[t.uid].map((function(){return r.a.createElement(d.a,{borderRadius:"sm",w:"8px",bg:"green.400"})})),Object(O.a)(Array.from(Array(10-h.hits[t.uid].length))).map((function(){return r.a.createElement(d.a,{borderRadius:"sm",w:"8px",bg:"purple.400"})})))),r.a.createElement(d.a,{textAlign:"right"},r.a.createElement(b.a,{fontSize:"0.75rem"},h.opponentName||h.opponent||"Opponent"),h.hits&&r.a.createElement(d.a,{d:"flex",w:"128px",h:"32px",borderRadius:"md",bg:"purple.500",justifyContent:"space-around",p:1,mb:2,transform:"skewX(-12deg)"},h.hits[P].map((function(){return r.a.createElement(d.a,{borderRadius:"sm",w:"8px",bg:"red.400"})})),Object(O.a)(Array.from(Array(10-h.hits[P].length))).map((function(){return r.a.createElement(d.a,{borderRadius:"sm",w:"8px",bg:"purple.400"})}))))),z?r.a.createElement(U.a,{gridTemplateColumns:"repeat(10, 1fr)",w:"100%",maxW:"550px",margin:"0 auto",border:"2px solid",borderColor:"blue.200"},H.map((function(e,t){return e.map((function(e,a){return r.a.createElement(d.a,{key:"".concat(t,"-").concat(a),border:"2px solid",borderColor:"blue.200",w:"100%",paddingTop:"100%",bg:h.hits[P].includes("x".concat(t,"y").concat(a))?"red.500":h.tries[P].includes("x".concat(t,"y").concat(a))?"green.300":"blue.300"})}))}))):r.a.createElement(U.a,{gridTemplateColumns:"repeat(10, 1fr)",w:"100%",maxW:"550px",margin:"0 auto",border:"2px solid",borderColor:"blue.200"},H.map((function(e,a){return e.map((function(e,n){return r.a.createElement(Y.a,{onClick:function(){return N("x".concat(a,"y").concat(n))},key:"".concat(a,"-").concat(n),isDisabled:h.tries[t.uid].includes("x".concat(a,"y").concat(n)),border:"2px solid",borderColor:"blue.200",borderRadius:"none",w:"100%",paddingTop:"100%",_hover:{boxShadow:"inset 0px 0px 0px 2px red"},_disabled:{boxShadow:"none"},_active:{},transition:"none",bg:h.hits[t.uid].includes("x".concat(a,"y").concat(n))?"green.300":h.tries[t.uid].includes("x".concat(a,"y").concat(n))?"red.500":"blue.300"},r.a.createElement(b.a,null))}))}))),r.a.createElement(f.a,{margin:"0 auto",p:8},r.a.createElement(Y.a,{mr:2,variantColor:"teal",isDisabled:!z,onClick:function(){return B(!1)}},"Playing board"),r.a.createElement(Y.a,{variantColor:"teal",isDisabled:z,onClick:function(){return B(!0)}},"My board"))):h.hasPlaced&&h.hasPlaced.includes(null===t||void 0===t?void 0:t.uid)?r.a.createElement(T.a,null,"Waiting for opponent to place their ships"):r.a.createElement(r.a.Fragment,null,r.a.createElement(T.a,{py:4},"Select 10 squares to place ships on"),r.a.createElement(U.a,{gridTemplateColumns:"repeat(10, 1fr)",w:"100%",maxW:"550px",margin:"0 auto",border:"2px solid",borderColor:"blue.200"},H.map((function(e,t){return e.map((function(e,a){return r.a.createElement(d.a,{as:"button",onClick:function(){return e="x".concat(t,"y").concat(a),void j((function(t){return t.includes(e)?t.filter((function(t){return t!==e})):w.length<10?[].concat(Object(O.a)(t),[e]):t}));var e},key:"".concat(t,"-").concat(a),outline:"none",border:"2px solid",borderColor:"blue.200",w:"100%",paddingTop:"100%",bg:w.includes("x".concat(t,"y").concat(a))?"green.300":"blue.300"})}))}))),r.a.createElement(d.a,{p:8},r.a.createElement(M,{w:"100%",justifyContent:"center",isDisabled:10!==w.length,onClick:function(){return F()}},r.a.createElement(b.a,{fontSize:"1.25rem",fontWeight:"700",color:"white",textShadow:"1px 1px 0px rgba(0,0,0,0.2)"},10!==w.length?"".concat(10-w.length," squares left"):"Submit placement"))))))},X=a(154),G=a(155),J=function(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(),i=Object(s.a)(c,2),d=i[0],p=i[1];Object(n.useEffect)((function(){a.length<3||f(a)}),[a]);var m=function(){var e=Object(u.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=y.httpsCallable("sendFriendRequest"),e.next=4,a({userId:t});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(u.a)(l.a.mark((function e(t){var a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.collection("public-users").doc(t).get();case 3:if((a=e.sent).exists){e.next=8;break}return p(void 0),console.log("No user found"),e.abrupt("return");case 8:n=a.data(),console.log(n),p(n),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(0),console.log("Error, No user found"),p(void 0);case 17:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(t){return e.apply(this,arguments)}}(),b=function(){p(void 0),o("")};return r.a.createElement(r.a.Fragment,null,r.a.createElement(X.a,{bg:"purple.400",color:"purple.900",h:"52px",border:"none",placeholder:"Friend Code",_placeholder:{color:"purple.700"},value:a,onChange:function(e){return o(e.target.value)}}),r.a.createElement(G.a,{isOpen:!!d,onClose:b},r.a.createElement(G.g,null),d&&r.a.createElement(G.d,null,r.a.createElement(G.f,null,d.displayName),r.a.createElement(G.c,null),r.a.createElement(G.b,null),r.a.createElement(G.e,null,r.a.createElement(Y.a,{variantColor:"blue",mr:3,onClick:b},"Close"),r.a.createElement(Y.a,{variantColor:"green",onClick:function(){return m(d.userId)}},"Add friend")))))},V=function(){var e=Object(n.useContext)(v).user,t=Object(n.useRef)([]),a=Object(n.useState)([]),o=Object(s.a)(a,2),c=o[0],i=o[1];Object(n.useEffect)((function(){if(e){var a=C.collection("users").doc(null===e||void 0===e?void 0:e.uid).collection("friends").onSnapshot((function(e){e.docChanges().forEach((function(e){var a=e.doc;if("added"===e.type){var n=Object(S.a)({},a.data(),{id:a.id});t.current=[].concat(Object(O.a)(t.current),[n])}if("modified"===e.type){var r=a.id;t.current=t.current.map((function(e){return e.id!==r?e:Object(S.a)({},a.data(),{id:a.id})}))}if("removed"===e.type){var o=a.id;t.current=t.current.filter((function(e){return e.id!==o}))}})),i(t.current)}));return function(){a()}}}),[e]);var p=function(){var e=Object(u.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=y.httpsCallable("sendChallenge"),e.next=4,a({userId:t});case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(k.b,null,c.map((function(e){return r.a.createElement(k.a,{d:"flex",py:4,alignItems:"center",justifyContent:"space-between",key:e.id,borderBottom:"2px solid",borderColor:"purple.700"},r.a.createElement(b.a,{fontSize:"1.5rem"},e.displayName),r.a.createElement(M,{variantColor:"orange.300",onClick:function(){return p(e.userId)}},r.a.createElement(d.a,{w:"32px",h:"32px",mr:2},r.a.createElement("img",{src:"/icons/swords.svg",alt:""})),r.a.createElement(b.a,{fontSize:"1.25rem",fontWeight:"700",color:"white",textShadow:"1px 1px 0px rgba(0,0,0,0.2)"},"Challenge")))})))},K=function(){var e=Object(n.useContext)(v),t=e.user,a=e.displayName,o=Object(n.useRef)([]),c=Object(n.useState)([]),i=Object(s.a)(c,2),l=i[0],u=i[1];return Object(n.useEffect)((function(){if(t){var e=C.collection("users").doc(null===t||void 0===t?void 0:t.uid).collection("games").onSnapshot((function(e){e.docChanges().forEach((function(e){var t=e.doc;if("added"===e.type){var a=Object(S.a)({},t.data(),{id:t.id});o.current=[].concat(Object(O.a)(o.current),[a])}if("modified"===e.type){var n=t.id;o.current=o.current.map((function(e){return e.id!==n?e:Object(S.a)({},t.data(),{id:t.id})}))}if("removed"===e.type){var r=t.id;o.current=o.current.filter((function(e){return e.id!==r}))}})),u(o.current)}));return function(){e()}}}),[t]),r.a.createElement(k.b,null,l.map((function(e){return console.log(e),r.a.createElement(k.a,{key:e.id,mb:4,p:4,borderRadius:"lg",bg:"purple.700"},r.a.createElement(f.a,{justifyContent:"space-between"},r.a.createElement(d.a,null,r.a.createElement(b.a,{fontSize:"0.75rem"},a),e.hits&&r.a.createElement(d.a,{borderRadius:"md",d:"flex",w:"128px",h:"32px",bg:"purple.500",justifyContent:"space-around",p:1,transform:"skewX(12deg)"},e.hits[t.uid].map((function(){return r.a.createElement(d.a,{borderRadius:"sm",w:"8px",bg:"green.400"})})),Object(O.a)(Array.from(Array(10-e.hits[t.uid].length))).map((function(){return r.a.createElement(d.a,{borderRadius:"sm",w:"8px",bg:"purple.400"})})))),r.a.createElement(d.a,{textAlign:"right"},r.a.createElement(b.a,{fontSize:"0.75rem"},e.opponentName||e.opponent),e.hits&&r.a.createElement(d.a,{d:"flex",w:"128px",h:"32px",borderRadius:"md",bg:"purple.500",justifyContent:"space-around",p:1,mb:2,transform:"skewX(-12deg)"},e.hits[e.opponent].map((function(){return r.a.createElement(d.a,{borderRadius:"sm",w:"8px",bg:"red.400"})})),Object(O.a)(Array.from(Array(10-e.hits[e.opponent].length))).map((function(){return r.a.createElement(d.a,{borderRadius:"sm",w:"8px",bg:"purple.400"})}))))),r.a.createElement(g.b,{to:"/game/".concat(e.id)},r.a.createElement(M,{mt:4,w:"100%",justifyContent:"center",variantColor:e.currentPlayer===(null===t||void 0===t?void 0:t.uid)?"teal.400":"purple.400"},r.a.createElement(b.a,{whiteSpace:"nowrap",fontSize:"1.25rem",fontWeight:"700",color:"white",textShadow:"1px 1px 0px rgba(0,0,0,0.2)"},e.currentPlayer===(null===t||void 0===t?void 0:t.uid)?"Your turn":"View game"))))})))},Z=function(){var e=Object(n.useContext)(v),t=e.displayName,a=e.friendCode;return r.a.createElement(U.a,{templateColumns:"1fr 1fr",p:8,gridGap:8},r.a.createElement(d.a,{bg:"purple.800",p:8,rounded:"lg",boxShadow:"0px 0px 0px 8px #6B46C1"},r.a.createElement(K,null)),r.a.createElement(d.a,{bg:"purple.800",p:8,rounded:"lg",boxShadow:"0px 0px 0px 8px #6B46C1"},r.a.createElement(T.a,null,t," (",a,")"),r.a.createElement(T.a,{mt:8,mb:2,size:"md",fontWeight:"900",textShadow:"1px 1px 0px rgba(0,0,0,0.4)",letterSpacing:"1px"},"Friends"),r.a.createElement(V,null),r.a.createElement(T.a,{mt:8,mb:2,size:"md",fontWeight:"900",textShadow:"1px 1px 0px rgba(0,0,0,0.4)",letterSpacing:"1px"},"Add new friends"),r.a.createElement(J,null)))},$=a(50),ee=a(147),te=a(148),ae=function(){var e=Object(n.useState)(""),t=Object(s.a)(e,2),a=t[0],o=t[1],c=Object(n.useState)(""),i=Object(s.a)(c,2),p=i[0],m=i[1],b=Object(n.useState)(),h=Object(s.a)(b,2),g=h[0],v=h[1],x=Object(n.useState)(!1),E=Object(s.a)(x,2),w=E[0],C=E[1],y=function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,C(!0),e.next=5,j.signInWithEmailAndPassword(a,p);case 5:v(void 0),C(!1),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(1),v(e.t0),C(!1);case 13:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,j.signInAnonymously();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.error(e.t0);case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(f.a,{align:"center",justify:"center",w:"100%",minH:"100vh"},r.a.createElement(f.a,{direction:"column"},r.a.createElement(d.a,{as:"form",mb:4,onSubmit:y},r.a.createElement($.a,{isInvalid:!!g},r.a.createElement(ee.a,{htmlFor:"email"},"Email"),r.a.createElement(X.a,{name:"email",placeholder:"E-mail",value:a,onChange:function(e){return o(e.target.value)}}),r.a.createElement(ee.a,{htmlFor:"password"},"Password"),r.a.createElement(X.a,{name:"password",type:"password",placeholder:"Password",value:p,onChange:function(e){return m(e.target.value)}}),r.a.createElement(te.a,null,g&&g.message)),r.a.createElement(Y.a,{mt:4,variantColor:"teal",isLoading:w,type:"submit"},"Sign in with email/password")),r.a.createElement(Y.a,{onClick:O,variantColor:"teal",variant:"ghost"},"Continue without signing in")))},ne=new D,re=function(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),a=t[0],o=t[1],c=Object(n.useRef)(),i=Object(n.useRef)(),f=Object(m.f)(),b=Object(n.useState)(0),h=Object(s.a)(b,2),g=h[0],x=h[1],E=Object(n.useState)(!1),w=Object(s.a)(E,2),y=w[0],O=w[1],S=Object(n.useState)(!0),k=Object(s.a)(S,2),I=k[0],A=k[1],R=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return O(!0),M(),e.next=6,ne.joinQueue(a.uid);case 6:ne.subMatchmaking(a.uid,(function(e){var t,a;(null===(t=e.data())||void 0===t?void 0:t.gameId)&&(W(),f.push("/game/".concat(null===(a=e.data())||void 0===a?void 0:a.gameId)))}),(function(e){console.error(e)}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){c.current=setInterval((function(){x((function(e){return e+1}))}),1e3)},W=function(){a&&(O(!1),function(e){e.current&&clearInterval(e.current)}(c),x(0),i.current&&i.current(),ne.exitQueue(a.uid))};Object(n.useEffect)((function(){var e=j.onAuthStateChanged(function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o(t||null),A(!1);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return function(){e(),ne.unsubMatchmaking()}}),[]);var z=Object(n.useState)({}),B=Object(s.a)(z,2),F=B[0],P=B[1];return Object(n.useEffect)((function(){if(a){var e=C.collection("users").doc(null===a||void 0===a?void 0:a.uid).onSnapshot((function(e){e.exists&&P(e.data())}));return function(){e()}}}),[a]),I?r.a.createElement(d.a,{as:"main",h:"100vh",overflow:"auto",bg:"gray.900",color:"white"},r.a.createElement(p.a,{color:"white",position:"absolute",top:"50%",left:"50%",transform:"translate3d(-50%, -50%, 0)",size:"xl"})):a?r.a.createElement(v.Provider,{value:{user:a,displayName:F.displayName||"",friendCode:F.friendCode||""}},r.a.createElement(d.a,{as:"main",h:"100vh",overflow:"auto",background:"linear-gradient(152deg, #6B46C1 0%, #553C9A 100%)",color:"white"},r.a.createElement(N,{onStartMatchmaking:R,onStopMatchmaking:W,isMatchmaking:y,time:g}),r.a.createElement(m.c,null,r.a.createElement(m.a,{path:"/game/:gameId"},r.a.createElement(Q,null)),r.a.createElement(m.a,{path:"/"},r.a.createElement(Z,null))))):r.a.createElement(ae,null)},oe=a(16),ce=a(13),ie=a(156),le=a(150),ue=Object(S.a)({},le.a,{fonts:{heading:'\'Nunito\', -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',body:'\'Nunito\', -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"',mono:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'}});c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(oe.a,{theme:ue},r.a.createElement(ce.a,{value:"light"},r.a.createElement(ie.a,null),r.a.createElement(g.a,null,r.a.createElement(re,null))))),document.getElementById("root"))},92:function(e,t,a){e.exports=a(137)}},[[92,1,2]]]);
//# sourceMappingURL=main.6ddb6827.chunk.js.map