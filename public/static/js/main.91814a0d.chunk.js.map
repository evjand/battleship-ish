{"version":3,"sources":["context/userContext.ts","firebaseApp.ts","components/UI/IconButton.tsx","components/UI/RaisedButton.tsx","components/FriendRequests.tsx","components/GameChallenges.tsx","components/Presence.tsx","components/Header.tsx","FirebaseMatchmakingManager.ts","components/GameBoardSquare.tsx","components/GamePlacementGrid.tsx","components/Score.tsx","pages/Game.tsx","components/AddFriends.tsx","components/FriendList.tsx","components/GameItem.tsx","components/GameList.tsx","pages/Home.tsx","pages/Login.tsx","components/Footer.tsx","App.tsx","theme.ts","index.tsx","sounds/notification1.wav","sounds/accepted.wav","sounds/decline.wav","sounds/notification3.wav","sounds/hit.wav","sounds/miss.wav","sounds/notallowed.wav"],"names":["UserContext","React","createContext","user","displayName","friendCode","app","firebase","apiKey","process","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","auth","firestore","functions","IconButton","children","variantColor","isLoading","props","isDisabled","splitColor","split","colorGrade","parseInt","color","PseudoBox","as","d","bg","p","alignItems","borderRadius","borderBottomColor","Math","min","borderBottomWidth","transition","outline","position","_hover","backgroundColor","_focus","boxShadow","_active","mt","_disabled","opacity","cursor","Flex","Spinner","pos","top","left","w","h","RaisedButton","py","pb","px","aria-disabled","notificationFx","UIFx","notificationSound","volume","throttleMs","acceptedFx","acceptedSound","declineFx","declineSound","FriendRequests","useContext","friendsReqRef","useRef","useState","friendsReq","setFriendsReq","requestsLoading","setRequestsLoading","useEffect","unsubFriendsReq","collection","doc","uid","onSnapshot","query","docChanges","forEach","change","type","data","id","current","play","map","game","filter","acceptFriendRequest","userId","a","includes","ids","func","httpsCallable","console","error","declineFriendRequest","requestId","delete","Popover","Box","mr","src","alt","length","display","justifyContent","fontSize","fontWeight","right","zIndex","maxW","borderColor","List","friendReq","key","borderBottom","Text","whiteSpace","onClick","textShadow","GameChallenges","challengesRef","challenges","setChallenges","unsubChallenges","challenge","declineChallenge","challengeId","acceptChallenge","Presence","presenceRef","usersOnline","setUsersOnline","unsubPresence","addPresence","setupBeforeUnloadListener","deletePresence","set","lastOnline","FieldValue","serverTimestamp","log","window","addEventListener","ev","preventDefault","Heading","Header","align","justify","to","Menu","Avatar","size","name","undefined","border","signOut","FirebaseMatchmakingManager","matchmakingListener","joinQueue","created","exitQueue","subMatchmaking","success","includeMetadataChanges","unsubMatchmaking","GameBoardSquare","xIndex","yIndex","trySquare","isPersonalBoard","opponent","players","find","player","square","hit","hits","flatMap","ship","sunk","tried","tries","paddingTop","minW","backgroundRepeat","backgroundPosition","backgroundSize","backgroundImage","xy","Array","from","defaultShipPosition","carrier","x","y","rotated","battleship","destroyer","submarine","patrol","shipLength","GamePlacementGrid","onShipsPlaced","gridRef","lastShipDragged","shipPlacement","setShipPlacement","shipDragPosition","setShipDragPosition","gridWidth","setGridWidth","isOverlapping","setIsOverlapping","bind","useGesture","onDrag","movement","mx","my","handleDrag","onDragStart","event","handleDragStart","target","onDragEnd","handleDragEnd","currentShipPlacement","newX","max","floor","newY","newPosition","domElement","dataset","newPlacement","placementObject","Object","entries","reduce","acc","value","positions","_","index","flatArray","values","flat","Set","width","getBoundingClientRect","calculateYPosition","calculateXPosition","widthForShip","heightForShip","Grid","gridTemplateColumns","margin","ref","yArray","checked","keys","style","height","transform","data-ship","pt","flexDir","Button","currentShip","isRotated","rotateShip","Score","isOpponent","skewDeg","hitColor","mb","hitFx","hitSound","missFx","missSound","notAllowedFx","notAllowedSound","Game","toast","useToast","gameId","useParams","setGame","placement","setPlacement","canSendPlacement","setCanSendPlacement","isTrying","setIsTrying","showOwnBoard","setShowOwnBoard","personalPlacement","setPersonalPlacement","unsubGames","snapshot","get","then","catch","err","currentPlayer","title","description","status","duration","isClosable","trySquareFunc","response","isHit","gameIsWon","confirmPlacement","update","hasPlaced","direction","winner","state","textAlign","flexWrap","ml","AddFriends","searchQuery","setSearchQuery","foundUser","setFoundUser","loading","setLoading","searchForUsers","sendFriendRequest","publicUserSnapshot","exists","publicUser","onClose","handleAdd","Input","placeholder","_placeholder","onChange","Modal","isOpen","FriendList","friendsRef","friends","setFriends","challengesLoading","setChallengesLoading","unsubFriends","sendChallenge","friend","GameItem","opponentName","GameList","gamesRef","games","setGames","notStarted","playing","done","Home","onStartMatchmaking","onStopMatchmaking","isMatchmaking","time","templateColumns","base","md","gridGap","rounded","letterSpacing","Login","email","setEmail","password","setPassword","formError","setFormError","isLoggingIn","setIsLoggingIn","handleSubmit","signInWithEmailAndPassword","signInAnonymously","minH","onSubmit","FormControl","isInvalid","FormLabel","htmlFor","FormErrorMessage","message","Footer","Link","textDecoration","href","isExternal","Icon","matchmakingManager","App","setUser","timerRef","history","useHistory","setTime","setIsMatchmaking","initialLoad","setInitialLoad","startMatchmaking","startTimer","stopMatchmaking","push","setInterval","clearInterval","stopTimer","unsubAuth","onAuthStateChanged","userData","setUserData","unsubUserdata","overflow","Provider","background","path","customTheme","theme","fonts","heading","body","mono","ReactDOM","render","StrictMode","ThemeProvider","ColorModeProvider","CSSReset","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.91814a0d.chunk.js","sourcesContent":["import React from 'react'\nimport * as firebase from 'firebase'\n\ninterface UserContext {\n  user: firebase.User | null\n  displayName: string\n  friendCode: string\n}\n\nconst UserContext = React.createContext<UserContext>({\n  user: null,\n  displayName: '',\n  friendCode: '',\n})\nexport default UserContext\n","// Firebase App (the core Firebase SDK) is always required and must be listed first\nimport * as firebase from 'firebase/app'\n\n// If you enabled Analytics in your project, add the Firebase SDK for Analytics\n//import \"firebase/analytics\";\n\n// Add the Firebase products that you want to use\nimport 'firebase/auth'\nimport 'firebase/firestore'\nimport 'firebase/functions'\n\nconst firebaseConfig = {\n  apiKey: process.env.REACT_APP_FIREBASE_API_KEY,\n  authDomain: 'battleship-ish.firebaseapp.com',\n  databaseURL: 'https://battleship-ish.firebaseio.com',\n  projectId: 'battleship-ish',\n  storageBucket: 'battleship-ish.appspot.com',\n  messagingSenderId: '57723460313',\n  appId: '1:57723460313:web:f55fa72d03e38eea77bcc8',\n}\n// Initialize Firebase\nconst app = firebase.initializeApp(firebaseConfig)\n\nconst auth = app.auth()\nconst firestore = app.firestore()\nconst functions = app.functions('europe-west1')\n\nexport { auth, firestore, functions }\n","import React from 'react'\nimport { PseudoBox, PseudoBoxProps, ButtonProps, Flex, Spinner } from '@chakra-ui/core'\n\ninterface IconButton {\n  variantColor?: string\n}\n\nconst IconButton: React.FC<PseudoBoxProps & ButtonProps & IconButton> = ({\n  children,\n  variantColor = 'purple.300',\n  isLoading,\n  isDisabled,\n  ...props\n}) => {\n  const splitColor = variantColor.split('.')\n  const colorGrade = parseInt(splitColor[1], 10)\n  const color = splitColor[0]\n  return (\n    <PseudoBox\n      as=\"button\"\n      d=\"flex\"\n      bg={variantColor}\n      p={2}\n      alignItems=\"center\"\n      borderRadius={6}\n      borderBottomColor={`${color}.${Math.min(colorGrade + 100, 900)}`}\n      borderBottomWidth={4}\n      transition=\"all 0.2s ease\"\n      outline=\"none\"\n      position=\"relative\"\n      _hover={{\n        backgroundColor: `${color}.${Math.min(colorGrade + 100, 900)}`,\n        borderBottomColor: `${color}.${Math.min(colorGrade + 200, 900)}`,\n      }}\n      _focus={{\n        boxShadow: 'outline',\n      }}\n      _active={{\n        borderBottomWidth: '2px',\n        mt: '2px',\n      }}\n      _disabled={{\n        opacity: 0.5,\n        cursor: 'not-allowed',\n      }}\n      {...props}\n    >\n      <Flex opacity={isLoading ? 0 : 1}>{children}</Flex>\n      <Spinner\n        opacity={isLoading ? 1 : 0}\n        pos=\"absolute\"\n        top=\"calc(50% - 12px)\"\n        left=\"calc(50% - 12px)\"\n        w=\"24px\"\n        h=\"24px\"\n      />\n    </PseudoBox>\n  )\n}\n\nexport default IconButton\n","import { ButtonProps, Flex, PseudoBox, PseudoBoxProps, Spinner } from '@chakra-ui/core'\nimport React from 'react'\n\ninterface RaisedButtonProps {\n  variantColor?: string\n}\n\nconst RaisedButton: React.FC<PseudoBoxProps & ButtonProps & RaisedButtonProps> = ({\n  children,\n  variantColor = 'purple.400',\n  isDisabled,\n  isLoading,\n  ...props\n}) => {\n  const splitColor = variantColor.split('.')\n  const colorGrade = parseInt(splitColor[1], 10)\n  const color = splitColor[0]\n  return (\n    <PseudoBox\n      as=\"button\"\n      d=\"flex\"\n      bg={variantColor}\n      py={2}\n      pb={1}\n      px={4}\n      alignItems=\"center\"\n      borderRadius={6}\n      borderBottomColor={`${color}.${Math.min(colorGrade + 100, 900)}`}\n      borderBottomWidth={4}\n      transition=\"all 0.2s ease\"\n      outline=\"none\"\n      pos=\"relative\"\n      aria-disabled={isDisabled}\n      _hover={{\n        backgroundColor: `${color}.${Math.min(colorGrade + 100, 900)}`,\n        borderBottomColor: `${color}.${Math.min(colorGrade + 200, 900)}`,\n      }}\n      _focus={{\n        boxShadow: 'outline',\n      }}\n      _active={{\n        borderBottomWidth: '2px',\n        mt: '2px',\n      }}\n      _disabled={{\n        opacity: 0.5,\n        cursor: 'not-allowed',\n      }}\n      {...props}\n    >\n      <Flex opacity={isLoading ? 0 : 1}>{children}</Flex>\n      <Spinner\n        opacity={isLoading ? 1 : 0}\n        pos=\"absolute\"\n        top=\"calc(50% - 12px)\"\n        left=\"calc(50% - 12px)\"\n        w=\"24px\"\n        h=\"24px\"\n      />\n    </PseudoBox>\n  )\n}\n\nexport default RaisedButton\n","import {\n  Box,\n  Flex,\n  List,\n  ListItem,\n  Popover,\n  PopoverArrow,\n  PopoverBody,\n  PopoverContent,\n  PopoverHeader,\n  PopoverTrigger,\n  Text,\n} from '@chakra-ui/core'\nimport React, { useContext, useEffect, useRef, useState } from 'react'\nimport UserContext from '../context/userContext'\nimport { firestore, functions } from '../firebaseApp'\nimport IconButton from './UI/IconButton'\nimport RaisedButton from './UI/RaisedButton'\nimport UIFx from 'uifx'\nimport notificationSound from '../sounds/notification1.wav'\nimport acceptedSound from '../sounds/accepted.wav'\nimport declineSound from '../sounds/decline.wav'\n\nconst notificationFx = new UIFx(notificationSound, {\n  volume: 0.5,\n  throttleMs: 100,\n})\n\nconst acceptedFx = new UIFx(acceptedSound, {\n  volume: 0.5,\n  throttleMs: 100,\n})\n\nconst declineFx = new UIFx(declineSound, {\n  volume: 0.5,\n  throttleMs: 100,\n})\n\nconst FriendRequests = () => {\n  const { user } = useContext(UserContext)\n  const friendsReqRef = useRef<any[]>([])\n  const [friendsReq, setFriendsReq] = useState<any[]>([])\n  const [requestsLoading, setRequestsLoading] = useState<string[]>([])\n\n  useEffect(() => {\n    if (!user) return\n\n    const unsubFriendsReq = firestore\n      .collection('users')\n      .doc(user?.uid)\n      .collection('friend-requests')\n      .onSnapshot((query) => {\n        query.docChanges().forEach((change) => {\n          const doc = change.doc\n          if (change.type === 'added') {\n            const data = { ...doc.data(), id: doc.id }\n            friendsReqRef.current = [...friendsReqRef.current, data]\n            notificationFx.play()\n          }\n          if (change.type === 'modified') {\n            const id = doc.id\n            friendsReqRef.current = friendsReqRef.current.map((game) => {\n              if (game.id !== id) return game\n              return { ...doc.data(), id: doc.id }\n            })\n          }\n          if (change.type === 'removed') {\n            const id = doc.id\n            friendsReqRef.current = friendsReqRef.current.filter((game) => game.id !== id)\n          }\n        })\n        setFriendsReq(friendsReqRef.current)\n      })\n\n    return () => {\n      unsubFriendsReq()\n    }\n  }, [notificationFx, user])\n\n  const acceptFriendRequest = async (userId: string) => {\n    if (requestsLoading.includes(userId)) return\n    try {\n      setRequestsLoading((ids) => [...ids, userId])\n      const func = functions.httpsCallable('acceptFriendRequest')\n      await func({ userId })\n      acceptedFx.play()\n      setRequestsLoading((ids) => ids.filter((id) => id !== userId))\n    } catch (error) {\n      setRequestsLoading((ids) => ids.filter((id) => id !== userId))\n      console.error(error)\n    }\n  }\n\n  const declineFriendRequest = async (requestId: string) => {\n    if (requestsLoading.includes(requestId)) return\n    try {\n      setRequestsLoading((ids) => [...ids, requestId])\n      await firestore.collection('users').doc(user?.uid).collection('friend-requests').doc(requestId).delete()\n      declineFx.play()\n      setRequestsLoading((ids) => ids.filter((id) => id !== requestId))\n    } catch (error) {\n      setRequestsLoading((ids) => ids.filter((id) => id !== requestId))\n      console.error(error)\n    }\n  }\n\n  return (\n    <Popover>\n      <PopoverTrigger>\n        <Box as=\"button\" w=\"32px\" h=\"32px\" mr={4} pos=\"relative\">\n          <img src=\"/icons/users.svg\" alt=\"\" />\n          {friendsReq.length > 0 && (\n            <Box\n              pos=\"absolute\"\n              display=\"fled\"\n              justifyContent=\"center\"\n              alignItems=\"center\"\n              w={5}\n              h={5}\n              borderRadius=\"full\"\n              bg=\"red.500\"\n              color=\"white\"\n              fontSize=\"0.75rem\"\n              fontWeight=\"800\"\n              top=\"-0.5rem\"\n              right=\"-0.5rem\"\n            >\n              {friendsReq.length}\n            </Box>\n          )}\n        </Box>\n      </PopoverTrigger>\n      <PopoverContent zIndex={4} w=\"400px\" maxW=\"calc(100% - 32px)\" bg=\"purple.600\" borderColor=\"purple.700\">\n        <PopoverArrow />\n        <PopoverHeader borderColor=\"purple.700\">Friend requests</PopoverHeader>\n        <PopoverBody>\n          <List>\n            {friendsReq.map((friendReq) => {\n              return (\n                <ListItem\n                  d=\"flex\"\n                  p={2}\n                  alignItems=\"center\"\n                  justifyContent=\"space-between\"\n                  key={friendReq.id}\n                  borderBottom=\"1px solid\"\n                  borderColor=\"purple.700\"\n                >\n                  <Text whiteSpace=\"nowrap\" mr={4}>\n                    {friendReq.displayName}\n                  </Text>\n                  <Flex>\n                    <RaisedButton\n                      isLoading={requestsLoading.includes(friendReq.id)}\n                      isDisabled={requestsLoading.includes(friendReq.id)}\n                      mr={2}\n                      variantColor=\"green.400\"\n                      onClick={() => acceptFriendRequest(friendReq.id)}\n                    >\n                      <Box w=\"32px\" h=\"32px\" mr={2}>\n                        <img src=\"/icons/like.svg\" alt=\"\" />\n                      </Box>\n                      <Text fontSize=\"1.25rem\" fontWeight=\"700\" color=\"white\" textShadow=\"1px 1px 0px rgba(0,0,0,0.2)\">\n                        Accept\n                      </Text>\n                    </RaisedButton>\n                    <IconButton\n                      isLoading={requestsLoading.includes(friendReq.id)}\n                      isDisabled={requestsLoading.includes(friendReq.id)}\n                      variantColor=\"red.400\"\n                      onClick={() => declineFriendRequest(friendReq.id)}\n                    >\n                      <Box w=\"32px\" h=\"32px\">\n                        <img src=\"/icons/bad.svg\" alt=\"\" />\n                      </Box>\n                    </IconButton>\n                  </Flex>\n                </ListItem>\n              )\n            })}\n          </List>\n        </PopoverBody>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\nexport default FriendRequests\n","import {\n  Box,\n  Flex,\n  List,\n  ListItem,\n  Popover,\n  PopoverArrow,\n  PopoverBody,\n  PopoverContent,\n  PopoverHeader,\n  PopoverTrigger,\n  Text,\n} from '@chakra-ui/core'\nimport React, { useContext, useEffect, useRef, useState } from 'react'\nimport UserContext from '../context/userContext'\nimport { firestore, functions } from '../firebaseApp'\nimport IconButton from './UI/IconButton'\nimport RaisedButton from './UI/RaisedButton'\n\nimport UIFx from 'uifx'\nimport notificationSound from '../sounds/notification1.wav'\nimport acceptedSound from '../sounds/accepted.wav'\nimport declineSound from '../sounds/decline.wav'\n\nconst notificationFx = new UIFx(notificationSound, {\n  volume: 0.5,\n  throttleMs: 100,\n})\n\nconst acceptedFx = new UIFx(acceptedSound, {\n  volume: 0.5,\n  throttleMs: 100,\n})\n\nconst declineFx = new UIFx(declineSound, {\n  volume: 0.5,\n  throttleMs: 100,\n})\n\nconst GameChallenges = () => {\n  const { user } = useContext(UserContext)\n  const challengesRef = useRef<any[]>([])\n  const [challenges, setChallenges] = useState<any[]>([])\n  const [requestsLoading, setRequestsLoading] = useState<string[]>([])\n\n  useEffect(() => {\n    if (!user) return\n\n    const unsubChallenges = firestore\n      .collection('users')\n      .doc(user?.uid)\n      .collection('challenges')\n      .onSnapshot((query) => {\n        query.docChanges().forEach((change) => {\n          const doc = change.doc\n          if (change.type === 'added') {\n            const data = { ...doc.data(), id: doc.id }\n            challengesRef.current = [...challengesRef.current, data]\n            notificationFx.play()\n          }\n          if (change.type === 'modified') {\n            const id = doc.id\n            challengesRef.current = challengesRef.current.map((challenge) => {\n              if (challenge.id !== id) return challenge\n              return { ...doc.data(), id: doc.id }\n            })\n          }\n          if (change.type === 'removed') {\n            const id = doc.id\n            challengesRef.current = challengesRef.current.filter((challenge) => challenge.id !== id)\n          }\n        })\n        setChallenges(challengesRef.current)\n      })\n\n    return () => {\n      unsubChallenges()\n    }\n  }, [user])\n\n  const declineChallenge = async (challengeId: string) => {\n    if (requestsLoading.includes(challengeId)) return\n    try {\n      setRequestsLoading((ids) => [...ids, challengeId])\n      await firestore.collection('users').doc(user?.uid).collection('challenges').doc(challengeId).delete()\n      declineFx.play()\n      setRequestsLoading((ids) => ids.filter((id) => id !== challengeId))\n    } catch (error) {\n      setRequestsLoading((ids) => ids.filter((id) => id !== challengeId))\n      console.error(error)\n    }\n  }\n\n  const acceptChallenge = async (userId: string) => {\n    if (requestsLoading.includes(userId)) return\n    try {\n      setRequestsLoading((ids) => [...ids, userId])\n      const func = functions.httpsCallable('acceptChallenge')\n      await func({ userId })\n      acceptedFx.play()\n      setRequestsLoading((ids) => ids.filter((id) => id !== userId))\n    } catch (error) {\n      setRequestsLoading((ids) => ids.filter((id) => id !== userId))\n      console.error(error)\n    }\n  }\n\n  return (\n    <Popover>\n      <PopoverTrigger>\n        <Box as=\"button\" w=\"32px\" h=\"32px\" mr={4} pos=\"relative\">\n          <img src=\"/icons/bell.svg\" alt=\"\" />\n          {challenges.length > 0 && (\n            <Box\n              pos=\"absolute\"\n              display=\"fled\"\n              justifyContent=\"center\"\n              alignItems=\"center\"\n              w={5}\n              h={5}\n              borderRadius=\"full\"\n              bg=\"red.500\"\n              color=\"white\"\n              fontSize=\"0.75rem\"\n              fontWeight=\"800\"\n              top=\"-0.5rem\"\n              right=\"-0.5rem\"\n            >\n              {challenges.length}\n            </Box>\n          )}\n        </Box>\n      </PopoverTrigger>\n      <PopoverContent zIndex={4} w=\"400px\" maxW=\"calc(100% - 32px)\" bg=\"purple.600\" borderColor=\"purple.700\">\n        <PopoverArrow />\n        <PopoverHeader borderColor=\"purple.700\">Game challenges</PopoverHeader>\n        <PopoverBody>\n          <List>\n            {challenges.map((challenge) => {\n              return (\n                <ListItem\n                  d=\"flex\"\n                  p={2}\n                  alignItems=\"center\"\n                  justifyContent=\"space-between\"\n                  key={challenge.id}\n                  borderBottom=\"1px solid\"\n                  borderColor=\"purple.700\"\n                >\n                  <Text whiteSpace=\"nowrap\" mr={4}>\n                    {challenge.displayName}\n                  </Text>\n                  <Flex>\n                    <RaisedButton\n                      isLoading={requestsLoading.includes(challenge.id)}\n                      isDisabled={requestsLoading.includes(challenge.id)}\n                      mr={2}\n                      variantColor=\"green.400\"\n                      onClick={() => acceptChallenge(challenge.userId)}\n                    >\n                      <Box w=\"32px\" h=\"32px\" mr={2}>\n                        <img src=\"/icons/like.svg\" alt=\"\" />\n                      </Box>\n                      <Text fontSize=\"1.25rem\" fontWeight=\"700\" color=\"white\" textShadow=\"1px 1px 0px rgba(0,0,0,0.2)\">\n                        Accept\n                      </Text>\n                    </RaisedButton>\n                    <IconButton\n                      isLoading={requestsLoading.includes(challenge.id)}\n                      isDisabled={requestsLoading.includes(challenge.id)}\n                      variantColor=\"red.400\"\n                      onClick={() => declineChallenge(challenge.id)}\n                    >\n                      <Box w=\"32px\" h=\"32px\">\n                        <img src=\"/icons/bad.svg\" alt=\"\" />\n                      </Box>\n                    </IconButton>\n                  </Flex>\n                </ListItem>\n              )\n            })}\n          </List>\n        </PopoverBody>\n      </PopoverContent>\n    </Popover>\n  )\n}\n\nexport default GameChallenges\n","import { Heading } from '@chakra-ui/core'\nimport firebase from 'firebase'\nimport React, { useContext, useEffect, useRef, useState } from 'react'\nimport UserContext from '../context/userContext'\nimport { firestore } from '../firebaseApp'\n\nconst Presence = () => {\n  const { user } = useContext(UserContext)\n  const presenceRef = useRef<any[]>([])\n  const [usersOnline, setUsersOnline] = useState<string[]>([])\n  useEffect(() => {\n    if (!user) return\n    const unsubPresence = firestore.collection('presence').onSnapshot((query) => {\n      query.docChanges().forEach((change) => {\n        const doc = change.doc\n        if (change.type === 'added') {\n          const data = { ...doc.data(), id: doc.id }\n          presenceRef.current = [...presenceRef.current, data]\n        }\n        if (change.type === 'modified') {\n          const id = doc.id\n          presenceRef.current = presenceRef.current.map((uid) => {\n            if (uid.id !== id) return uid\n            return { ...doc.data(), id: doc.id }\n          })\n        }\n        if (change.type === 'removed') {\n          const id = doc.id\n          presenceRef.current = presenceRef.current.filter((uid) => uid.id !== id)\n        }\n      })\n      setUsersOnline(presenceRef.current)\n    })\n\n    addPresence(user.uid)\n    setupBeforeUnloadListener()\n    return () => {\n      unsubPresence()\n      deletePresence(user.uid)\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [user])\n\n  const addPresence = async (userId: string) => {\n    try {\n      await firestore\n        .collection('presence')\n        .doc(userId)\n        .set({ lastOnline: firebase.firestore.FieldValue.serverTimestamp() })\n    } catch (error) {\n      console.log(userId)\n      console.log('Cant add presence')\n    }\n  }\n\n  const deletePresence = async (userId: string) => {\n    try {\n      await firestore.collection('presence').doc(userId).delete()\n    } catch (error) {\n      console.log(userId)\n      console.log('Cant delete presence')\n      console.log(error)\n    }\n  }\n\n  const setupBeforeUnloadListener = () => {\n    if (!user) return\n    window.addEventListener('beforeunload', (ev) => {\n      ev.preventDefault()\n      return deletePresence(user.uid)\n    })\n  }\n\n  return <Heading>Users online: {usersOnline.length}</Heading>\n}\n\nexport default Presence\n","import { Avatar, Flex, Menu, MenuButton, MenuItem, MenuList } from '@chakra-ui/core'\nimport React, { FC, useContext } from 'react'\nimport { Link } from 'react-router-dom'\nimport UserContext from '../context/userContext'\nimport { auth } from '../firebaseApp'\nimport FriendRequests from './FriendRequests'\nimport GameChallenges from './GameChallenges'\nimport Presence from './Presence'\n\nconst Header: FC = () => {\n  const { user } = useContext(UserContext)\n\n  const signOut = () => {\n    auth.signOut()\n  }\n\n  return (\n    <Flex\n      px={4}\n      align=\"center\"\n      justify=\"space-between\"\n      bg=\"purple.800\"\n      borderBottomWidth=\"2px\"\n      borderBottomColor=\"purple.900\"\n      w=\"100%\"\n      h=\"5rem\"\n    >\n      <Link to=\"/\">FireShips</Link>\n      <Presence />\n      <Flex>\n        <FriendRequests />\n        <GameChallenges />\n        <Menu>\n          <MenuButton>\n            <Avatar size=\"sm\" name={user?.displayName ?? undefined} />\n          </MenuButton>\n          <MenuList border=\"none\" boxShadow=\"md\" bg=\"purple.500\">\n            <MenuItem\n              _hover={{ backgroundColor: 'purple.600' }}\n              _focus={{ backgroundColor: 'purple.600' }}\n              onClick={signOut}\n            >\n              Sign out\n            </MenuItem>\n          </MenuList>\n        </Menu>\n      </Flex>\n    </Flex>\n  )\n}\n\nexport default Header\n","import firebase from 'firebase'\nimport { firestore } from './firebaseApp'\n\nclass FirebaseMatchmakingManager {\n  matchmakingListener: (() => void) | null = null\n\n  joinQueue = (uid: string): Promise<void> => {\n    return firestore\n      .collection('matchmaking')\n      .doc(uid)\n      .set({ created: firebase.firestore.FieldValue.serverTimestamp() })\n  }\n\n  exitQueue = (uid: string): Promise<void> => {\n    return firestore.collection('matchmaking').doc(uid).delete()\n  }\n\n  subMatchmaking = (\n    uid: string,\n    success: (snapshot: firebase.firestore.DocumentSnapshot<firebase.firestore.DocumentData>) => void,\n    error: (error: Error) => void\n  ) => {\n    this.matchmakingListener = firestore\n      .collection('matchmaking')\n      .doc(uid)\n      .onSnapshot({ includeMetadataChanges: false }, success, error)\n  }\n\n  unsubMatchmaking = () => {\n    this.matchmakingListener && this.matchmakingListener()\n  }\n}\n\nexport default FirebaseMatchmakingManager\n","import React, { FC, useContext } from 'react'\nimport { PseudoBox } from '@chakra-ui/core'\nimport UserContext from '../context/userContext'\n\ninterface GameBoardSquareProps {\n  xIndex: number\n  yIndex: number\n  game: Game\n  trySquare: (square: string) => void\n  isPersonalBoard: boolean\n}\n\nconst GameBoardSquare: FC<GameBoardSquareProps> = ({ xIndex, yIndex, game, trySquare, isPersonalBoard }) => {\n  const { user } = useContext(UserContext)\n  const opponent = game?.players.find((player: string) => player !== user!.uid)!\n  const square = `x${xIndex}y${yIndex}`\n  const hits: { square: string; sunk: boolean }[] = game.hits[\n    !isPersonalBoard ? user!.uid : opponent\n  ].flatMap((ship: HitShip) => ship.hits.map((hit) => ({ square: hit, sunk: ship.sunk })))\n  const hit: { square: string; sunk: boolean } | undefined = hits.find((h) => h.square === square)\n  const tried = game.tries[!isPersonalBoard ? user!.uid : opponent].includes(square)\n  return (\n    <PseudoBox\n      as={tried || isPersonalBoard ? 'div' : 'button'}\n      onClick={() => trySquare(square)}\n      key={`${xIndex}-${yIndex}`}\n      aria-disabled={tried}\n      border=\"2px solid\"\n      borderColor={hit && hit.sunk ? 'red.800' : 'blue.500'}\n      borderRadius=\"none\"\n      w=\"100%\"\n      p={0}\n      paddingTop=\"calc(100% - 4px)\"\n      minW=\"auto\"\n      h=\"auto\"\n      _hover={{\n        boxShadow: tried || isPersonalBoard ? 'none' : 'inset 0px 0px 0px 2px red',\n      }}\n      _disabled={{\n        boxShadow: 'none',\n        cursor: 'default',\n      }}\n      _active={{}}\n      opacity={hit && hit.sunk ? 0.8 : 1}\n      transition=\"none\"\n      backgroundRepeat=\"no-repeat\"\n      backgroundPosition=\"center center\"\n      backgroundSize=\"80%\"\n      backgroundColor={hit ? (hit.sunk ? 'red.800' : 'blue.800') : tried ? 'blue.800' : 'blue.700'}\n      backgroundImage={hit ? 'url(/icons/explosion.svg)' : tried ? 'url(/icons/miss.svg)' : 'none'}\n    />\n  )\n}\n\nexport default GameBoardSquare\n","import { Box, Button, Flex, Grid } from '@chakra-ui/core'\nimport React, { FC, useEffect, useRef, useState } from 'react'\nimport { useGesture } from 'react-use-gesture'\n\nconst xy = Array.from(Array(10)).map(() => Array.from(Array(10)).map(() => false))\n\nconst defaultShipPosition: { [key: string]: { x: number; y: number; rotated: boolean } } = {\n  carrier: { x: 0, y: 0, rotated: false },\n  battleship: { x: 0, y: 1, rotated: false },\n  destroyer: { x: 0, y: 2, rotated: false },\n  submarine: { x: 0, y: 3, rotated: false },\n  patrol: { x: 0, y: 4, rotated: false },\n}\n\nconst shipLength: { [key: string]: number } = {\n  carrier: 5,\n  battleship: 4,\n  destroyer: 3,\n  submarine: 3,\n  patrol: 2,\n}\n\nconst GamePlacementGrid: FC<{\n  onShipsPlaced: (positions: { [key: string]: [string] }, isOverlapping: boolean) => void\n}> = ({ onShipsPlaced }) => {\n  const gridRef = useRef()\n  const lastShipDragged = useRef<string>('')\n  const [shipPlacement, setShipPlacement] = useState<any>(defaultShipPosition)\n  const [shipDragPosition, setShipDragPosition] = useState<any | undefined>()\n  const [gridWidth, setGridWidth] = useState<number>(0)\n  const [isOverlapping, setIsOverlapping] = useState<boolean>(false)\n\n  const bind = useGesture({\n    onDrag: ({ movement: [mx, my] }) => {\n      handleDrag(mx, my)\n    },\n    onDragStart: ({ event }) => {\n      handleDragStart(event!.target)\n    },\n    onDragEnd: ({ movement: [mx, my] }) => {\n      handleDragEnd(mx, my)\n    },\n  })\n\n  const handleDrag = (x: number, y: number) => {\n    const currentShipPlacement = shipPlacement[lastShipDragged.current]\n    const newX = Math.min(\n      10 - (!currentShipPlacement.rotated ? shipLength[lastShipDragged.current] : 1),\n      Math.max(0, currentShipPlacement.x + Math.floor(x / gridWidth))\n    )\n    const newY = Math.min(\n      10 - (currentShipPlacement.rotated ? shipLength[lastShipDragged.current] : 1),\n      Math.max(0, currentShipPlacement.y + Math.floor(y / gridWidth))\n    )\n    const newPosition = { ...currentShipPlacement, x: newX, y: newY }\n    setShipDragPosition({ ...shipPlacement, [lastShipDragged.current]: newPosition })\n  }\n\n  const handleDragStart = (target: EventTarget) => {\n    const domElement = target as HTMLElement\n    lastShipDragged.current = domElement.dataset.ship || lastShipDragged.current\n  }\n\n  const handleDragEnd = (x: number, y: number) => {\n    const currentShipPlacement = shipPlacement[lastShipDragged.current]\n    const newX = Math.min(\n      10 - (!currentShipPlacement.rotated ? shipLength[lastShipDragged.current] : 1),\n      Math.max(0, currentShipPlacement.x + Math.floor(x / gridWidth))\n    )\n    const newY = Math.min(\n      10 - (currentShipPlacement.rotated ? shipLength[lastShipDragged.current] : 1),\n      Math.max(0, currentShipPlacement.y + Math.floor(y / gridWidth))\n    )\n    const newPosition = { ...currentShipPlacement, x: newX, y: newY }\n    const newPlacement = { ...shipPlacement, [lastShipDragged.current]: newPosition }\n    setShipPlacement(newPlacement)\n    setShipDragPosition(undefined)\n\n    const placementObject = Object.entries<{ x: number; y: number; rotated: boolean }>(newPlacement).reduce(\n      (acc, [key, value]) => {\n        return {\n          ...acc,\n          [key]: {\n            positions: [...Array(shipLength[key])].map((_, index) =>\n              value.rotated ? `x${value.x}y${value.y + index}` : `x${value.x + index}y${value.y}`\n            ),\n          },\n        }\n      },\n      {}\n    )\n\n    const flatArray = Object.values<{ positions: [string] }>(placementObject)\n      .map((p) => p.positions)\n      .flat()\n    const isOverlapping = new Set(flatArray).size !== flatArray.length\n    onShipsPlaced(placementObject, isOverlapping)\n  }\n\n  useEffect(() => {\n    const positions = Object.entries<{ x: number; y: number; rotated: boolean }>(shipPlacement).map(([key, value]) => {\n      return [...Array(shipLength[key])].map((_, index) =>\n        value.rotated ? `x${value.x}y${value.y + index}` : `x${value.x + index}y${value.y}`\n      )\n    })\n    const placementObject = Object.entries<{ x: number; y: number; rotated: boolean }>(shipPlacement).reduce(\n      (acc, [key, value]) => {\n        return {\n          ...acc,\n          [key]: {\n            positions: [...Array(shipLength[key])].map((_, index) =>\n              value.rotated ? `x${value.x}y${value.y + index}` : `x${value.x + index}y${value.y}`\n            ),\n          },\n        }\n      },\n      {}\n    )\n    const flatArray = positions.flat()\n    const isOverlapping = new Set(flatArray).size !== flatArray.length\n    setIsOverlapping(isOverlapping)\n    onShipsPlaced(placementObject, isOverlapping)\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [shipPlacement])\n\n  useEffect(() => {\n    const grid: HTMLElement = gridRef.current!\n    const rect = grid.getBoundingClientRect()\n    const width = (rect.width - 4) / 10\n    setGridWidth(width)\n  }, [])\n\n  const calculateYPosition = (ship: string) => {\n    if (shipDragPosition) {\n      return `${shipDragPosition[ship].y * gridWidth}px`\n    }\n    return `${shipPlacement[ship].y * gridWidth}px`\n  }\n\n  const calculateXPosition = (ship: string) => {\n    if (shipDragPosition) {\n      return `${shipDragPosition[ship].x * gridWidth}px`\n    }\n    return `${shipPlacement[ship].x * gridWidth}px`\n  }\n\n  const rotateShip = (ship: string) => {\n    const currentShip = shipPlacement[ship]\n    const isRotated = currentShip.rotated\n\n    if (isRotated) {\n      const newX = Math.min(10 - shipLength[ship], currentShip.x)\n      setShipPlacement({ ...shipPlacement, [ship]: { ...currentShip, x: newX, rotated: !isRotated } })\n    } else {\n      const newY = Math.min(10 - shipLength[ship], currentShip.y)\n      setShipPlacement({ ...shipPlacement, [ship]: { ...currentShip, y: newY, rotated: !isRotated } })\n    }\n  }\n\n  const widthForShip = (ship: string) => {\n    if (shipPlacement[ship].rotated) {\n      return `${gridWidth - 16}px`\n    }\n    return `${shipLength[ship] * gridWidth - 16}px`\n  }\n\n  const heightForShip = (ship: string) => {\n    if (shipPlacement[ship].rotated) {\n      return `${shipLength[ship] * gridWidth - 16}px`\n    }\n    return `${gridWidth - 16}px`\n  }\n\n  return (\n    <>\n      <Grid\n        gridTemplateColumns=\"repeat(10, 1fr)\"\n        w=\"100%\"\n        maxW=\"550px\"\n        margin=\"0 auto\"\n        border=\"2px solid\"\n        borderColor=\"blue.500\"\n        pos=\"relative\"\n        ref={gridRef}\n      >\n        {xy.map((yArray, xIndex) => {\n          return yArray.map((checked, yIndex) => (\n            <Box\n              key={`${xIndex}-${yIndex}`}\n              outline=\"none\"\n              border=\"2px solid\"\n              borderColor=\"blue.500\"\n              w=\"100%\"\n              paddingTop=\"calc(100% - 4px)\"\n              bg=\"blue.700\"\n            ></Box>\n          ))\n        })}\n        {Object.keys(shipPlacement).map((ship) => {\n          return (\n            <Box\n              key={ship}\n              style={{\n                width: widthForShip(ship),\n                height: heightForShip(ship),\n                top: calculateYPosition(ship),\n                left: calculateXPosition(ship),\n              }}\n              borderRadius=\"full\"\n              transform=\"translate3d(8px, 8px, 0px)\"\n              bg=\"gray.400\"\n              border=\"4px solid\"\n              borderColor={lastShipDragged.current === ship ? 'gray.300' : 'transparent'}\n              boxShadow={lastShipDragged.current === ship ? 'lg' : 'none'}\n              zIndex={lastShipDragged.current === ship ? 2 : 1}\n              opacity={0.95}\n              pos=\"absolute\"\n              data-ship={ship}\n              {...bind()}\n            ></Box>\n          )\n        })}\n      </Grid>\n      <Flex pt={4} w=\"200px\" margin=\"0 auto\" flexDir=\"column\">\n        <Button\n          variantColor=\"blue\"\n          isDisabled={!lastShipDragged.current}\n          onClick={() => rotateShip(lastShipDragged.current)}\n        >\n          Rotate selected ship\n        </Button>\n        {isOverlapping ? 'Ships are overlapping' : 'Ships are well placed'}\n      </Flex>\n    </>\n  )\n}\n\nexport default GamePlacementGrid\n","import React, { FC } from 'react'\nimport { Box } from '@chakra-ui/core'\n\ninterface ScoreProps {\n  isOpponent: boolean\n  hits: string[]\n}\n\nconst Score: FC<ScoreProps> = ({ isOpponent, hits }) => {\n  console.log(hits)\n  const skewDeg = isOpponent ? -12 : 12\n  const hitColor = isOpponent ? 'red.400' : 'green.400'\n  return (\n    <Box\n      d=\"flex\"\n      w=\"212px\"\n      h=\"32px\"\n      borderRadius=\"md\"\n      bg=\"purple.500\"\n      justifyContent=\"space-around\"\n      p={1}\n      mb={2}\n      transform={`skewX(${skewDeg}deg)`}\n    >\n      {hits.map((hit) => (\n        <Box key={hit} borderRadius=\"sm\" w=\"8px\" bg={hitColor}></Box>\n      ))}\n      {[...Array.from(Array(17 - hits.length))].map((_, index) => (\n        <Box key={`index${index}`} borderRadius=\"sm\" w=\"8px\" bg=\"purple.400\"></Box>\n      ))}\n    </Box>\n  )\n}\n\nexport default Score\n","import { Box, Button, Flex, Grid, Heading, Text, useToast } from '@chakra-ui/core'\nimport React, { useContext, useEffect, useRef, useState } from 'react'\nimport { useParams } from 'react-router'\nimport GameBoardSquare from '../components/GameBoardSquare'\nimport GamePlacementGrid from '../components/GamePlacementGrid'\nimport Score from '../components/Score'\nimport RaisedButton from '../components/UI/RaisedButton'\nimport UserContext from '../context/userContext'\nimport { firestore, functions } from '../firebaseApp'\n\nimport UIFx from 'uifx'\nimport notificationSound from '../sounds/notification3.wav'\nimport hitSound from '../sounds/hit.wav'\nimport missSound from '../sounds/miss.wav'\nimport notAllowedSound from '../sounds/notallowed.wav'\n\nconst notificationFx = new UIFx(notificationSound, {\n  volume: 0.2,\n  throttleMs: 500,\n})\n\nconst hitFx = new UIFx(hitSound, {\n  volume: 0.5,\n  throttleMs: 500,\n})\n\nconst missFx = new UIFx(missSound, {\n  volume: 0.5,\n  throttleMs: 500,\n})\n\nconst notAllowedFx = new UIFx(notAllowedSound, {\n  volume: 0.5,\n  throttleMs: 500,\n})\n\nconst xy = Array.from(Array(10)).map(() => Array.from(Array(10)).map(() => false))\n\nconst shipLength = [5, 4, 3, 3, 2]\n\nconst Game = () => {\n  const { user, displayName } = useContext(UserContext)\n  const gridRef = useRef()\n  const toast = useToast()\n  const { gameId } = useParams()\n  const [game, setGame] = useState<Game>()\n  const [placement, setPlacement] = useState<{ [key: string]: [string] }>({})\n  const [canSendPlacement, setCanSendPlacement] = useState<boolean>(false)\n  const [isTrying, setIsTrying] = useState<boolean>(false)\n  const [showOwnBoard, setShowOwnBoard] = useState<boolean>(false)\n  const [personalPlacement, setPersonalPlacement] = useState<{ positions: string[] }[]>([])\n  const [gridWidth, setGridWidth] = useState<number>(0)\n\n  useEffect(() => {\n    if (!user) return\n\n    const unsubGames = firestore\n      .collection('games')\n      .doc(gameId)\n      .onSnapshot((snapshot) => {\n        const game: Game = { id: snapshot.id, ...snapshot.data()! } as Game\n        notificationFx.play()\n        setGame(game)\n      })\n\n    firestore\n      .collection('users')\n      .doc(user.uid)\n      .collection('games')\n      .doc(gameId)\n      .get()\n      .then((snapshot) => {\n        console.log(snapshot.data())\n        if (snapshot.data()!.placement) {\n          setPersonalPlacement(snapshot.data()!.placement)\n        }\n      })\n      .catch((err) => {\n        console.log(err)\n      })\n\n    return () => {\n      unsubGames()\n    }\n  }, [user, gameId])\n\n  useEffect(() => {\n    if (!gridRef.current) {\n      return\n    }\n    const grid: HTMLElement = gridRef.current!\n    const rect = grid.getBoundingClientRect()\n    const width = (rect.width - 4) / 10\n    setGridWidth(width)\n  }, [showOwnBoard])\n\n  const widthForShip = (ship: { positions: string[] }, index: number) => {\n    const rotated = parseInt(ship.positions[0][1], 10) === parseInt(ship.positions[1][1], 10)\n    if (rotated) {\n      return `${gridWidth - 16}px`\n    }\n    return `${shipLength[index] * gridWidth - 16}px`\n  }\n\n  const heightForShip = (ship: { positions: string[] }, index: number) => {\n    const rotated = parseInt(ship.positions[0][1], 10) === parseInt(ship.positions[1][1], 10)\n    if (rotated) {\n      return `${shipLength[index] * gridWidth - 16}px`\n    }\n    return `${gridWidth - 16}px`\n  }\n\n  const calculateYPosition = (ship: { positions: string[] }) => {\n    const y = parseInt(ship.positions[0][3], 10)\n    return `${y * gridWidth}px`\n  }\n\n  const calculateXPosition = (ship: { positions: string[] }) => {\n    const x = parseInt(ship.positions[0][1], 10)\n    return `${x * gridWidth}px`\n  }\n\n  const trySquare = async (square: string) => {\n    //functions.useFunctionsEmulator('http://localhost:5001')\n    if (game?.currentPlayer !== user?.uid || isTrying) {\n      notAllowedFx.play()\n      toast({\n        title: 'Not your turn.',\n        description: \"Couldn't fire rocket, its not your turn.\",\n        status: 'error',\n        duration: 3000,\n        isClosable: true,\n      })\n    } else {\n      const trySquareFunc = functions.httpsCallable('trySquare')\n      try {\n        setIsTrying(true)\n        const response = await trySquareFunc({ square, gameId })\n        const { isHit, gameIsWon } = response.data\n        if (isHit) {\n          hitFx.play()\n        } else {\n          missFx.play()\n        }\n        if (gameIsWon) {\n          toast({\n            title: 'You one the game!!',\n            description: 'Congrats',\n            status: 'success',\n            duration: 3000,\n            isClosable: true,\n          })\n        }\n\n        setIsTrying(false)\n      } catch (error) {\n        console.error(error)\n        setIsTrying(false)\n      }\n    }\n  }\n\n  const confirmPlacement = async () => {\n    if (Object.keys(placement).length !== 5) return\n    try {\n      await firestore\n        .collection('placements')\n        .doc(gameId)\n        .update({\n          [user!.uid]: Object.values(placement),\n        })\n      const hasPlaced = [...(game?.hasPlaced || []), user?.uid]\n      firestore.collection('games').doc(gameId).update({\n        hasPlaced,\n      })\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  if (!game?.players) return <Text>Loading</Text>\n\n  const opponent = game?.players.find((player: string) => player !== user!.uid)!\n\n  const handleShipsPlaced = (positions: { [key: string]: [string] }, isOverlapping: boolean) => {\n    setPlacement(positions)\n    setCanSendPlacement(!isOverlapping)\n  }\n\n  return (\n    <Flex direction=\"column\" justify=\"space-between\">\n      <Flex direction=\"column\" p={2}>\n        {game.winner && <Heading>Winner {game.winner === user?.uid ? 'You won' : 'Your opponent won'}</Heading>}\n        {game.state === 'PLAYING' ? (\n          <>\n            <Heading textAlign=\"center\">{game.currentPlayer === user?.uid ? 'Your' : 'Opponents'} turn</Heading>\n            <Flex flexWrap=\"wrap\" justifyContent=\"space-between\" w=\"100%\" maxW=\"550px\" margin=\"0 auto\" mb={2}>\n              <Box>\n                <Text fontSize=\"0.75rem\">{displayName}</Text>\n                {game.hits && (\n                  <Score\n                    isOpponent={false}\n                    hits={game.hits[user!.uid].flatMap((ship: { hits: string[]; sunk: boolean }) => ship.hits)}\n                  />\n                )}\n              </Box>\n              <Box ml=\"auto\" textAlign=\"right\">\n                <Text fontSize=\"0.75rem\">{opponent || 'Opponent'}</Text>\n                {game.hits && (\n                  <Score\n                    isOpponent\n                    hits={game.hits[opponent].flatMap((ship: { hits: string[]; sunk: boolean }) => ship.hits)}\n                  />\n                )}\n              </Box>\n            </Flex>\n            {!showOwnBoard ? (\n              <Grid\n                gridTemplateColumns=\"repeat(10, 1fr)\"\n                w=\"100%\"\n                maxW=\"550px\"\n                margin=\"0 auto\"\n                border=\"2px solid\"\n                borderColor=\"blue.500\"\n                boxShadow={game.currentPlayer === user?.uid ? '0px 0px 48px #FFEB3B' : 'none'}\n              >\n                {xy.map((yArray, yIndex) => {\n                  return yArray.map((checked, xIndex) => (\n                    <GameBoardSquare\n                      xIndex={xIndex}\n                      yIndex={yIndex}\n                      game={game}\n                      trySquare={trySquare}\n                      isPersonalBoard={false}\n                    />\n                  ))\n                })}\n              </Grid>\n            ) : (\n              <Grid\n                gridTemplateColumns=\"repeat(10, 1fr)\"\n                w=\"100%\"\n                maxW=\"550px\"\n                margin=\"0 auto\"\n                border=\"2px solid\"\n                borderColor=\"blue.500\"\n                position=\"relative\"\n                ref={gridRef}\n              >\n                {xy.map((yArray, yIndex) => {\n                  return yArray.map((checked, xIndex) => (\n                    <GameBoardSquare\n                      xIndex={xIndex}\n                      yIndex={yIndex}\n                      game={game}\n                      trySquare={trySquare}\n                      isPersonalBoard\n                    />\n                  ))\n                })}\n                {personalPlacement.map((ship, index) => {\n                  return (\n                    <Box\n                      style={{\n                        width: widthForShip(ship, index),\n                        height: heightForShip(ship, index),\n                        top: calculateYPosition(ship),\n                        left: calculateXPosition(ship),\n                      }}\n                      borderRadius=\"full\"\n                      transform=\"translate3d(8px, 8px, 0px)\"\n                      bg=\"gray.400\"\n                      border=\"4px solid\"\n                      opacity={0.35}\n                      pos=\"absolute\"\n                    ></Box>\n                  )\n                })}\n              </Grid>\n            )}\n            <Flex margin=\"0 auto\" p={8}>\n              <Button mr={2} variantColor=\"teal\" isDisabled={!showOwnBoard} onClick={() => setShowOwnBoard(false)}>\n                Playing board\n              </Button>\n              <Button variantColor=\"teal\" isDisabled={showOwnBoard} onClick={() => setShowOwnBoard(true)}>\n                My board\n              </Button>\n            </Flex>\n          </>\n        ) : game.hasPlaced && game.hasPlaced.includes(user!.uid) ? (\n          <Heading p={4} textAlign=\"center\">\n            Waiting for opponent to place their ships\n          </Heading>\n        ) : (\n          <>\n            <Heading p={4} textAlign=\"center\">\n              Drag your ship placements\n            </Heading>\n            <GamePlacementGrid onShipsPlaced={handleShipsPlaced} />\n            <Box p={8}>\n              <RaisedButton\n                w=\"100%\"\n                justifyContent=\"center\"\n                isDisabled={!canSendPlacement}\n                onClick={() => confirmPlacement()}\n              >\n                <Text fontSize=\"1.25rem\" fontWeight=\"700\" color=\"white\" textShadow=\"1px 1px 0px rgba(0,0,0,0.2)\">\n                  {!canSendPlacement ? `Position ships so they are not overlapping` : 'Submit placement'}\n                </Text>\n              </RaisedButton>\n            </Box>\n          </>\n        )}\n      </Flex>\n    </Flex>\n  )\n}\n\nexport default Game\n","import {\n  Input,\n  Modal,\n  ModalBody,\n  ModalCloseButton,\n  ModalContent,\n  ModalFooter,\n  ModalHeader,\n  ModalOverlay,\n  Text,\n} from '@chakra-ui/core'\nimport React, { useEffect, useState } from 'react'\nimport { firestore, functions } from '../firebaseApp'\nimport RaisedButton from './UI/RaisedButton'\n\ninterface PublicUser {\n  displayName: string\n  userId: string\n}\n\nconst AddFriends = () => {\n  const [searchQuery, setSearchQuery] = useState<string>('')\n  const [foundUser, setFoundUser] = useState<PublicUser | undefined>()\n  const [loading, setLoading] = useState<boolean>(false)\n\n  useEffect(() => {\n    if (searchQuery.length < 3) return\n\n    searchForUsers(searchQuery)\n  }, [searchQuery])\n\n  const sendFriendRequest = async (userId: string) => {\n    try {\n      const func = functions.httpsCallable('sendFriendRequest')\n      await func({ userId })\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  const searchForUsers = async (query: string) => {\n    try {\n      const publicUserSnapshot = await firestore.collection('public-users').doc(query).get()\n      if (!publicUserSnapshot.exists) {\n        setFoundUser(undefined)\n        console.log('No user found')\n        return\n      }\n      const publicUser: PublicUser = publicUserSnapshot.data() as PublicUser\n      console.log(publicUser)\n      setFoundUser(publicUser)\n    } catch (error) {\n      console.log('Error, No user found')\n      setFoundUser(undefined)\n    }\n  }\n\n  const onClose = () => {\n    setFoundUser(undefined)\n    setSearchQuery('')\n  }\n\n  const handleAdd = async (userId: string) => {\n    try {\n      setLoading(true)\n      await sendFriendRequest(userId)\n      setLoading(false)\n      onClose()\n    } catch (error) {\n      setLoading(false)\n      onClose()\n      console.log(error)\n    }\n  }\n\n  return (\n    <>\n      <Input\n        bg=\"purple.400\"\n        color=\"purple.900\"\n        h=\"52px\"\n        border=\"none\"\n        placeholder=\"Friend Code\"\n        _placeholder={{\n          color: 'purple.700',\n        }}\n        value={searchQuery}\n        onChange={(event: React.ChangeEvent<HTMLInputElement>) => setSearchQuery(event.target.value)}\n      />\n      <Modal isOpen={!!foundUser} onClose={onClose}>\n        <ModalOverlay />\n        {foundUser && (\n          <ModalContent borderRadius=\"lg\" bg=\"purple.200\">\n            <ModalHeader>{foundUser.displayName}</ModalHeader>\n            <ModalCloseButton />\n            <ModalBody></ModalBody>\n\n            <ModalFooter>\n              <RaisedButton isDisabled={loading} variantColor=\"gray.400\" mr={3} onClick={onClose}>\n                <Text whiteSpace=\"nowrap\" fontSize=\"1.25rem\" fontWeight=\"700\" color=\"black\">\n                  Close\n                </Text>\n              </RaisedButton>\n              <RaisedButton\n                isLoading={loading}\n                isDisabled={loading}\n                variantColor=\"green.400\"\n                onClick={() => handleAdd(foundUser.userId)}\n              >\n                <Text\n                  whiteSpace=\"nowrap\"\n                  fontSize=\"1.25rem\"\n                  fontWeight=\"700\"\n                  color=\"white\"\n                  textShadow=\"1px 1px 0px rgba(0,0,0,0.2)\"\n                >\n                  Add friend\n                </Text>\n              </RaisedButton>\n            </ModalFooter>\n          </ModalContent>\n        )}\n      </Modal>\n    </>\n  )\n}\n\nexport default AddFriends\n","import { Box, List, ListItem, Text } from '@chakra-ui/core'\nimport React, { useContext, useEffect, useRef, useState } from 'react'\nimport UserContext from '../context/userContext'\nimport { firestore, functions } from '../firebaseApp'\nimport RaisedButton from './UI/RaisedButton'\n\nconst FriendList = () => {\n  const { user } = useContext(UserContext)\n  const friendsRef = useRef<any[]>([])\n  const [friends, setFriends] = useState<any[]>([])\n  const [challengesLoading, setChallengesLoading] = useState<string[]>([])\n\n  useEffect(() => {\n    if (!user) return\n\n    const unsubFriends = firestore\n      .collection('users')\n      .doc(user?.uid)\n      .collection('friends')\n      .onSnapshot((query) => {\n        query.docChanges().forEach((change) => {\n          const doc = change.doc\n          if (change.type === 'added') {\n            const data = { ...doc.data(), id: doc.id }\n            friendsRef.current = [...friendsRef.current, data]\n          }\n          if (change.type === 'modified') {\n            const id = doc.id\n            friendsRef.current = friendsRef.current.map((game) => {\n              if (game.id !== id) return game\n              return { ...doc.data(), id: doc.id }\n            })\n          }\n          if (change.type === 'removed') {\n            const id = doc.id\n            friendsRef.current = friendsRef.current.filter((game) => game.id !== id)\n          }\n        })\n        setFriends(friendsRef.current)\n      })\n\n    return () => {\n      unsubFriends()\n    }\n  }, [user])\n\n  const sendChallenge = async (userId: string) => {\n    if (challengesLoading.includes(userId)) return\n    try {\n      setChallengesLoading((ids) => [...ids, userId])\n      const func = functions.httpsCallable('sendChallenge')\n      await func({ userId })\n      setChallengesLoading((ids) => ids.filter((id) => id !== userId))\n    } catch (error) {\n      setChallengesLoading((ids) => ids.filter((id) => id !== userId))\n      console.error(error)\n    }\n  }\n\n  return (\n    <List>\n      {friends.map((friend) => {\n        return (\n          <ListItem\n            d=\"flex\"\n            py={4}\n            alignItems=\"center\"\n            justifyContent=\"space-between\"\n            key={friend.id}\n            borderBottom=\"2px solid\"\n            borderColor=\"purple.700\"\n          >\n            <Text fontSize=\"1.25rem\">{friend.displayName}</Text>\n            <RaisedButton\n              isLoading={challengesLoading.includes(friend.userId)}\n              isDisabled={challengesLoading.includes(friend.userId)}\n              variantColor=\"orange.300\"\n              onClick={() => sendChallenge(friend.userId)}\n            >\n              <Box w=\"32px\" h=\"32px\" mr={2}>\n                <img src=\"/icons/swords.svg\" alt=\"\" />\n              </Box>\n              <Text fontSize=\"1.25rem\" fontWeight=\"700\" color=\"white\" textShadow=\"1px 1px 0px rgba(0,0,0,0.2)\">\n                Challenge\n              </Text>\n            </RaisedButton>\n          </ListItem>\n        )\n      })}\n    </List>\n  )\n}\n\nexport default FriendList\n","import React, { FC, useContext } from 'react'\nimport { ListItem, Flex, Box, Text } from '@chakra-ui/core'\nimport Score from './Score'\nimport { Link } from 'react-router-dom'\nimport RaisedButton from './UI/RaisedButton'\nimport UserContext from '../context/userContext'\n\ninterface GameItemProps {\n  game: UserGame\n}\n\nconst GameItem: FC<GameItemProps> = ({ game }) => {\n  const { user, displayName } = useContext(UserContext)\n  return (\n    <ListItem key={game.id} mb={4} p={4} borderRadius=\"lg\" bg=\"purple.700\">\n      <Flex flexWrap=\"wrap\" justifyContent=\"space-between\">\n        <Box>\n          <Text fontSize=\"0.75rem\">{displayName}</Text>\n          {game.hits && <Score isOpponent={false} hits={game.hits[user!.uid].flatMap((ship) => ship.hits)} />}\n        </Box>\n        <Box ml=\"auto\" textAlign=\"right\">\n          <Text fontSize=\"0.75rem\">{game.opponentName || game.opponent}</Text>\n          {game.hits && <Score isOpponent hits={game.hits[game.opponent].flatMap((ship) => ship.hits)} />}\n        </Box>\n      </Flex>\n      <Link to={`/game/${game.id}`}>\n        <RaisedButton\n          mt={4}\n          w=\"100%\"\n          justifyContent=\"center\"\n          variantColor={game.currentPlayer === user?.uid ? 'teal.400' : 'purple.400'}\n        >\n          <Text\n            whiteSpace=\"nowrap\"\n            fontSize=\"1.25rem\"\n            fontWeight=\"700\"\n            color=\"white\"\n            textShadow=\"1px 1px 0px rgba(0,0,0,0.2)\"\n          >\n            {game.currentPlayer === user?.uid ? 'Your turn' : game.state === 'PLAYING' ? 'View game' : 'Place ships'}\n          </Text>\n        </RaisedButton>\n      </Link>\n    </ListItem>\n  )\n}\n\nexport default GameItem\n","import { List, Heading } from '@chakra-ui/core'\nimport React, { useContext, useEffect, useRef, useState } from 'react'\nimport UserContext from '../context/userContext'\nimport { firestore } from '../firebaseApp'\nimport GameItem from './GameItem'\n\nconst GameList = () => {\n  const { user } = useContext(UserContext)\n  const gamesRef = useRef<any[]>([])\n  const [games, setGames] = useState<UserGame[]>([])\n\n  useEffect(() => {\n    if (!user) return\n\n    const unsubGames = firestore\n      .collection('users')\n      .doc(user?.uid)\n      .collection('games')\n      .onSnapshot((query) => {\n        query.docChanges().forEach((change) => {\n          const doc = change.doc\n          if (change.type === 'added') {\n            const data = { ...doc.data(), id: doc.id }\n            gamesRef.current = [...gamesRef.current, data]\n          }\n          if (change.type === 'modified') {\n            const id = doc.id\n            gamesRef.current = gamesRef.current.map((game) => {\n              if (game.id !== id) return game\n              return { ...doc.data(), id: doc.id }\n            })\n          }\n          if (change.type === 'removed') {\n            const id = doc.id\n            gamesRef.current = gamesRef.current.filter((game) => game.id !== id)\n          }\n        })\n        setGames(gamesRef.current)\n      })\n\n    return () => {\n      unsubGames()\n    }\n  }, [user])\n\n  const notStarted = games.filter((game) => !game.currentPlayer)\n  const playing = games.filter((game) => game.state === 'PLAYING')\n  const done = games.filter((game) => game.state === 'DONE')\n\n  return (\n    <List mt={4}>\n      {notStarted.length > 0 && <Heading>Not started</Heading>}\n      {notStarted.map((game) => {\n        return <GameItem key={game.id} game={game} />\n      })}\n      {playing.length > 0 && <Heading>Playing</Heading>}\n      {playing.map((game) => {\n        return <GameItem key={game.id} game={game} />\n      })}\n      {done.length > 0 && <Heading>Finished</Heading>}\n      {done.map((game) => {\n        return <GameItem key={game.id} game={game} />\n      })}\n    </List>\n  )\n}\n\nexport default GameList\n","import { Box, Grid, Heading, Text } from '@chakra-ui/core'\nimport React, { FC, useContext } from 'react'\nimport AddFriends from '../components/AddFriends'\nimport FriendList from '../components/FriendList'\nimport GameList from '../components/GameList'\nimport RaisedButton from '../components/UI/RaisedButton'\nimport UserContext from '../context/userContext'\n\nexport interface MatchmakingProps {\n  onStartMatchmaking: () => void\n  onStopMatchmaking: () => void\n  isMatchmaking: boolean\n  time: number\n}\n\nconst Home: FC<MatchmakingProps> = ({ onStartMatchmaking, onStopMatchmaking, isMatchmaking, time }) => {\n  const { displayName, friendCode } = useContext(UserContext)\n\n  return (\n    <Grid maxW=\"1200px\" margin=\"0 auto\" templateColumns={{ base: '1fr', md: '2fr 1fr' }} p={4} gridGap={6}>\n      <Box bg=\"purple.800\" p={4} rounded=\"lg\" boxShadow=\"0px 0px 0px 8px #6B46C1\">\n        {!isMatchmaking ? (\n          <RaisedButton w=\"100%\" justifyContent=\"center\" variantColor=\"teal.400\" onClick={onStartMatchmaking}>\n            <Text fontSize=\"1.25rem\" fontWeight=\"700\" color=\"white\" textShadow=\"1px 1px 0px rgba(0,0,0,0.2)\">\n              Search for opponent\n            </Text>\n          </RaisedButton>\n        ) : (\n          <RaisedButton w=\"100%\" justifyContent=\"center\" variantColor=\"teal.400\" onClick={onStopMatchmaking}>\n            <Text fontSize=\"1.25rem\" fontWeight=\"700\" color=\"white\" textShadow=\"1px 1px 0px rgba(0,0,0,0.2)\">\n              Searching for opponent ... {time}\n            </Text>\n          </RaisedButton>\n        )}\n        <GameList />\n      </Box>\n      <Box bg=\"purple.800\" p={4} rounded=\"lg\" boxShadow=\"0px 0px 0px 8px #6B46C1\">\n        <Heading>{displayName}</Heading>\n        <Heading size=\"md\">Friend code: {friendCode}</Heading>\n        <Heading mt={8} mb={2} size=\"md\" fontWeight=\"900\" textShadow=\"1px 1px 0px rgba(0,0,0,0.4)\" letterSpacing=\"1px\">\n          Friends\n        </Heading>\n        <FriendList />\n        <Heading mt={8} mb={2} size=\"md\" fontWeight=\"900\" textShadow=\"1px 1px 0px rgba(0,0,0,0.4)\" letterSpacing=\"1px\">\n          Add new friends\n        </Heading>\n        <AddFriends />\n      </Box>\n    </Grid>\n  )\n}\n\nexport default Home\n","import React, { useState } from 'react'\nimport { Box, Flex, FormControl, FormLabel, Input, FormErrorMessage, Button } from '@chakra-ui/core'\nimport { auth } from '../firebaseApp'\nimport RaisedButton from '../components/UI/RaisedButton'\n\ninterface EmailSigninError {\n  code: string\n  message: string\n}\n\nconst Login = () => {\n  const [email, setEmail] = useState<string>('')\n  const [password, setPassword] = useState<string>('')\n  const [formError, setFormError] = useState<EmailSigninError>()\n  const [isLoggingIn, setIsLoggingIn] = useState<boolean>(false)\n\n  const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault()\n    try {\n      setIsLoggingIn(true)\n      await auth.signInWithEmailAndPassword(email, password)\n      setFormError(undefined)\n      setIsLoggingIn(false)\n    } catch (error) {\n      setFormError(error)\n      setIsLoggingIn(false)\n    }\n  }\n\n  const signInAnonymously = async () => {\n    try {\n      await auth.signInAnonymously()\n    } catch (error) {\n      console.error(error)\n    }\n  }\n\n  return (\n    <Flex align=\"center\" justify=\"center\" w=\"100%\" minH=\"100vh\" bg=\"purple.600\">\n      <Flex direction=\"column\">\n        <RaisedButton onClick={signInAnonymously} variantColor=\"orange.400\" p={8} fontSize=\"2rem\" color=\"white\">\n          Click to play\n        </RaisedButton>\n        <Box as=\"form\" mt={12} onSubmit={handleSubmit}>\n          <FormControl isInvalid={!!formError}>\n            <FormLabel htmlFor=\"email\">Email</FormLabel>\n            <Input\n              name=\"email\"\n              placeholder=\"E-mail\"\n              value={email}\n              onChange={(event: React.ChangeEvent<HTMLInputElement>) => setEmail(event.target.value)}\n            />\n            <FormLabel htmlFor=\"password\">Password</FormLabel>\n            <Input\n              name=\"password\"\n              type=\"password\"\n              placeholder=\"Password\"\n              value={password}\n              onChange={(event: React.ChangeEvent<HTMLInputElement>) => setPassword(event.target.value)}\n            />\n            <FormErrorMessage>{formError && formError.message}</FormErrorMessage>\n          </FormControl>\n          <Button mt={4} variantColor=\"teal\" isLoading={isLoggingIn} type=\"submit\">\n            Sign in with email/password\n          </Button>\n        </Box>\n      </Flex>\n    </Flex>\n  )\n}\n\nexport default Login\n","import { Flex, Heading, Icon, Link, Text } from '@chakra-ui/core'\nimport React, { FC } from 'react'\n\nconst Footer: FC = () => {\n  return (\n    <Flex align=\"center\" justify=\"center\" flexWrap=\"wrap\" pt={8}>\n      <Flex flexDir=\"column\" p={4}>\n        <Heading size=\"md\">BETA</Heading>\n        <Text maxW=\"400px\">\n          This game is currently in a public beta, and that means stuff might be a little unstable and any game or user\n          data may be reset at any time.\n        </Text>\n      </Flex>\n      <Flex flexDir=\"column\" p={4}>\n        <Heading size=\"md\">Got feedback?</Heading>\n        <Text maxW=\"400px\">\n          Please join our{' '}\n          <Link textDecoration=\"underline\" color=\"purple.100\" href=\"http://discord.gg/vjWAPvC\" isExternal>\n            Discord <Icon name=\"external-link\" mx=\"2px\" />\n          </Link>{' '}\n          and give your feedback in the #beta-feedback channel.\n        </Text>\n      </Flex>\n      <Flex flexDir=\"column\" p={4}>\n        <Heading size=\"md\">Developed live on Twitch</Heading>\n        <Text maxW=\"400px\" mb={2}>\n          If you would like to see how this game develops, please checkout our{' '}\n          <Link textDecoration=\"underline\" color=\"purple.100\" href=\"https://twitch.tv/codepurpl\" isExternal>\n            Twitch stream. <Icon name=\"external-link\" mx=\"2px\" />\n          </Link>\n        </Text>\n        Copyright © 2020 - Purpl AS\n      </Flex>\n    </Flex>\n  )\n}\n\nexport default Footer\n","import { Box, Spinner } from '@chakra-ui/core'\nimport firebase from 'firebase'\nimport React, { useEffect, useRef, useState } from 'react'\nimport { Route, Switch, useHistory } from 'react-router-dom'\nimport Header from './components/Header'\nimport UserContext from './context/userContext'\nimport { auth, firestore } from './firebaseApp'\nimport FirebaseMatchmakingManager from './FirebaseMatchmakingManager'\nimport Game from './pages/Game'\nimport Home from './pages/Home'\nimport Login from './pages/Login'\nimport Footer from './components/Footer'\n\nconst matchmakingManager = new FirebaseMatchmakingManager()\n\nconst App = () => {\n  const [user, setUser] = useState<firebase.User | null>(null)\n  const timerRef = useRef<NodeJS.Timeout>()\n  const matchmakingListener = useRef<() => void>()\n\n  const history = useHistory()\n\n  const [time, setTime] = useState<number>(0)\n  const [isMatchmaking, setIsMatchmaking] = useState<boolean>(false)\n\n  const [initialLoad, setInitialLoad] = useState<boolean>(true)\n\n  const startMatchmaking = async () => {\n    if (!user) return\n    setIsMatchmaking(true)\n    startTimer()\n    await matchmakingManager.joinQueue(user.uid)\n    matchmakingManager.subMatchmaking(\n      user.uid,\n      (snapshot) => {\n        if (snapshot.data()?.gameId) {\n          stopMatchmaking()\n          history.push(`/game/${snapshot.data()?.gameId}`)\n        }\n      },\n      (error) => {\n        console.error(error)\n      }\n    )\n  }\n\n  const startTimer = () => {\n    timerRef.current = setInterval(() => {\n      setTime((time) => time + 1)\n    }, 1000)\n  }\n\n  const stopTimer = (timerRef: React.MutableRefObject<NodeJS.Timeout | undefined>) => {\n    timerRef.current && clearInterval(timerRef.current)\n  }\n\n  const stopMatchmaking = () => {\n    if (!user) return\n    setIsMatchmaking(false)\n    stopTimer(timerRef)\n    setTime(0)\n    matchmakingListener.current && matchmakingListener.current()\n    matchmakingManager.exitQueue(user.uid)\n  }\n\n  useEffect(() => {\n    const unsubAuth = auth.onAuthStateChanged(async (user) => {\n      if (user) {\n        setUser(user)\n      } else {\n        setUser(null)\n        try {\n          //await auth.signInAnonymously()\n        } catch (error) {\n          console.error(error)\n        }\n      }\n      setInitialLoad(false)\n    })\n\n    return () => {\n      unsubAuth()\n      matchmakingManager.unsubMatchmaking()\n    }\n  }, [])\n\n  const [userData, setUserData] = useState<any>({})\n\n  useEffect(() => {\n    if (!user) return\n\n    const unsubUserdata = firestore\n      .collection('users')\n      .doc(user?.uid)\n      .onSnapshot((snapshot) => {\n        if (snapshot.exists) {\n          setUserData(snapshot.data())\n        }\n      })\n\n    return () => {\n      unsubUserdata()\n    }\n  }, [user])\n\n  if (initialLoad)\n    return (\n      <Box as=\"main\" h=\"100vh\" overflow=\"auto\" bg=\"gray.900\" color=\"white\">\n        <Spinner\n          color=\"white\"\n          position=\"absolute\"\n          top=\"50%\"\n          left=\"50%\"\n          transform=\"translate3d(-50%, -50%, 0)\"\n          size=\"xl\"\n        />\n      </Box>\n    )\n\n  if (!user) {\n    return <Login></Login>\n  }\n\n  return (\n    <UserContext.Provider\n      value={{ user, displayName: userData.displayName || '', friendCode: userData.friendCode || '' }}\n    >\n      <Box\n        as=\"main\"\n        h=\"100vh\"\n        overflow=\"auto\"\n        background=\"linear-gradient(152deg, #6B46C1 0%, #553C9A 100%)\"\n        color=\"white\"\n      >\n        <Header></Header>\n\n        <Switch>\n          <Route path=\"/game/:gameId\">\n            <Game />\n          </Route>\n          <Route path=\"/\">\n            <Home\n              onStartMatchmaking={startMatchmaking}\n              onStopMatchmaking={stopMatchmaking}\n              isMatchmaking={isMatchmaking}\n              time={time}\n            />\n          </Route>\n        </Switch>\n        <Footer></Footer>\n      </Box>\n    </UserContext.Provider>\n  )\n}\n\nexport default App\n","import { theme } from '@chakra-ui/core'\n\n// Let's say you want to add custom colors\nconst customTheme = {\n  ...theme,\n  fonts: {\n    heading: `'Nunito', -apple-system, BlinkMacSystemFont, \"Segoe UI\", Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\"`,\n    body: `'Nunito', -apple-system, BlinkMacSystemFont, \"Segoe UI\", Helvetica, Arial, sans-serif, \"Apple Color Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\"`,\n    mono: `SFMono-Regular,Menlo,Monaco,Consolas,\"Liberation Mono\",\"Courier New\",monospace`,\n  },\n}\n\nexport default customTheme\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport { ThemeProvider, CSSReset, ColorModeProvider } from '@chakra-ui/core'\nimport { BrowserRouter as Router } from 'react-router-dom'\nimport theme from './theme'\n\nReactDOM.render(\n  <React.StrictMode>\n    <ThemeProvider theme={theme}>\n      <ColorModeProvider value=\"light\">\n        <CSSReset />\n        <Router>\n          <App />\n        </Router>\n      </ColorModeProvider>\n    </ThemeProvider>\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n","module.exports = __webpack_public_path__ + \"static/media/notification1.0cae592a.wav\";","module.exports = __webpack_public_path__ + \"static/media/accepted.1fcf8c00.wav\";","module.exports = __webpack_public_path__ + \"static/media/decline.08953c16.wav\";","module.exports = __webpack_public_path__ + \"static/media/notification3.0e9986fb.wav\";","module.exports = __webpack_public_path__ + \"static/media/hit.9a9c4d64.wav\";","module.exports = __webpack_public_path__ + \"static/media/miss.f7553dc9.wav\";","module.exports = __webpack_public_path__ + \"static/media/notallowed.f8d95f31.wav\";"],"sourceRoot":""}